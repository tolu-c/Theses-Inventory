"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[3757],{43757:(mt,m,i)=>{i.r(m),i.d(m,{SubscriptionsPageRoutingModule:()=>dt});var p=i(67522),r=i(35103),u=i(57999),I=i(5476),t=i(98678),l=(i(18203),i(61750),i(77176)),c=i(45608),x=i(74207),g=i(70463),C=i(25584),P=i(42620),E=i(15463),b=i(51603),B=i(8842),f=i(65706),O=i(84273),d=i(96342);const T=["ds-subscription-view",""],V=function(n,s){return[n,s]};function j(n,s){if(1&n&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275element(1,"ds-themed-type-badge",10),t.\u0275\u0275elementStart(2,"p")(3,"a",11),t.\u0275\u0275text(4),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementContainerEnd()),2&n){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("object",e.dso),t.\u0275\u0275advance(2),t.\u0275\u0275property("routerLink",t.\u0275\u0275pureFunction2(3,V,e.getPageRoutePrefix(),e.dso.id)),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(e.dsoNameService.getName(e.dso))}}function M(n,s){1&n&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"p",12),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"p",13),t.\u0275\u0275text(5),t.\u0275\u0275pipe(6,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd()),2&n&&(t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,2,"subscriptions.table.not-available")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(6,4,"subscriptions.table.not-available-message")))}function F(n,s){if(1&n&&(t.\u0275\u0275elementStart(0,"span",14),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&n){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(e.subscription.subscriptionType)}}function $(n,s){1&n&&(t.\u0275\u0275elementStart(0,"span"),t.\u0275\u0275text(1,","),t.\u0275\u0275elementEnd())}function L(n,s){if(1&n&&(t.\u0275\u0275elementStart(0,"span"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275template(3,$,2,0,"span",1),t.\u0275\u0275elementEnd()),2&n){const e=s.$implicit,o=s.index,a=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,2,"subscriptions.frequency."+e.value),""),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",o<a.subscription.subscriptionParameterList.length-1)}}function R(n,s){if(1&n&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,L,4,4,"span",15),t.\u0275\u0275elementContainerEnd()),2&n){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",e.subscription.subscriptionParameterList)}}let v=(()=>{class n{constructor(e,o,a){this.modalService=e,this.subscriptionService=o,this.dsoNameService=a,this.reload=new t.EventEmitter}getPageRoutePrefix(){let e;switch(this.dso.type.toString()){case"community":e=(0,C.A0)();break;case"collection":e=(0,P.E5)();break;case"item":e=(0,E.TO)()}return e}deleteSubscriptionPopup(e){if((0,c.Uh)(e.id)){const o=this.modalService.open(x.Y);o.componentInstance.dso=this.dso,o.componentInstance.headerLabel="confirmation-modal.delete-subscription.header",o.componentInstance.infoLabel="confirmation-modal.delete-subscription.info",o.componentInstance.cancelLabel="confirmation-modal.delete-subscription.cancel",o.componentInstance.confirmLabel="confirmation-modal.delete-subscription.confirm",o.componentInstance.brandColor="danger",o.componentInstance.confirmIcon="fas fa-trash",o.componentInstance.response.pipe((0,l.q)(1)).subscribe(a=>{a&&this.subscriptionService.deleteSubscription(e.id).subscribe(y=>{this.reload.emit()})})}}openSubscriptionModal(){this.modalRef=this.modalService.open(b.W),this.modalRef.componentInstance.dso=this.dso,this.modalRef.componentInstance.subscription=this.subscription,this.modalRef.componentInstance.updateSubscription.pipe((0,l.q)(1)).subscribe(e=>{this.subscription=e})}}return n.\u0275fac=function(e){return new(e||n)(t.\u0275\u0275directiveInject(f.FF),t.\u0275\u0275directiveInject(g.D),t.\u0275\u0275directiveInject(B._))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["","ds-subscription-view",""]],inputs:{subscription:"subscription",dso:"dso",eperson:"eperson"},outputs:{reload:"reload"},attrs:T,decls:15,vars:11,consts:[[1,"dso-info"],[4,"ngIf"],["class","subscription-type",4,"ngIf"],[1,"subscription-parameters"],[1,"subscription-actions"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm","access-control-editEPersonButton",3,"disabled","title","click"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-danger","btn-sm","access-control-deleteEPersonButton",3,"title","click"],[1,"fas","fa-trash-alt","fa-fw"],[3,"object"],[3,"routerLink"],[1,"my-0"],[1,"text-muted","my-0"],[1,"subscription-type"],[4,"ngFor","ngForOf"]],template:function(e,o){1&e&&(t.\u0275\u0275elementStart(0,"td",0),t.\u0275\u0275template(1,j,5,6,"ng-container",1),t.\u0275\u0275template(2,M,7,6,"ng-container",1),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"td"),t.\u0275\u0275template(4,F,2,1,"span",2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"td",3),t.\u0275\u0275template(6,R,2,1,"ng-container",1),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(7,"td",4)(8,"div",5)(9,"button",6),t.\u0275\u0275listener("click",function(y){return y.preventDefault(),o.openSubscriptionModal()}),t.\u0275\u0275pipe(10,"translate"),t.\u0275\u0275element(11,"i",7),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(12,"button",8),t.\u0275\u0275listener("click",function(){return o.deleteSubscriptionPopup(o.subscription)}),t.\u0275\u0275pipe(13,"translate"),t.\u0275\u0275element(14,"i",9),t.\u0275\u0275elementEnd()()()),2&e&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!!o.dso),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!o.dso),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!!o.subscription),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!!o.subscription),t.\u0275\u0275advance(3),t.\u0275\u0275property("disabled",!o.dso)("title",t.\u0275\u0275pipeBind1(10,7,"subscriptions.table.edit")),t.\u0275\u0275advance(3),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(13,9,"subscriptions.table.delete")))},dependencies:[r.sg,r.O5,p.rH,O.o,d.X$]}),n})(),z=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=t.\u0275\u0275defineInjector({imports:[r.ez,f.bz,I.UX,d.aw,p.Bz,u.m]}),n})(),N=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=t.\u0275\u0275defineInjector({imports:[r.ez,u.m,z]}),n})();var h=i(35841),U=i(32210),W=i(53426),A=i(77025),X=i(62103),D=i(90910),G=i(91809),Z=i(80863);function S(...n){const s=(0,Z.jO)(n);return s?(0,G.z)(S(...n),(0,D.Z)(s)):(0,A.e)((e,o)=>{(0,W.l)([e,...(0,X.k)(n)])(o)})}function H(...n){return S(...n)}var Q=i(48358),Y=i(27303),J=i(21160),K=i(20942),w=i(45180),k=i(81323),q=i(87483),_=i(38123),tt=i(10572),et=i(87586),nt=i(87657),it=i(78530),ot=i(41966);function st(n,s){1&n&&t.\u0275\u0275element(0,"ds-themed-loading")}function at(n,s){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"tr",13),t.\u0275\u0275listener("reload",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(a.refresh())}),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275pipe(2,"async"),t.\u0275\u0275elementEnd()}if(2&n){const e=s.$implicit;let o,a;t.\u0275\u0275property("dso",null==(o=t.\u0275\u0275pipeBind1(1,3,null==e?null:e.resource))?null:o.payload)("eperson",null==(a=t.\u0275\u0275pipeBind1(2,5,null==e?null:e.eperson))||null==a.payload?null:a.payload.id)("subscription",e)}}function rt(n,s){if(1&n&&(t.\u0275\u0275elementStart(0,"ds-pagination",7)(1,"div",8)(2,"table",9)(3,"thead")(4,"tr")(5,"th",10),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"th",11),t.\u0275\u0275text(9),t.\u0275\u0275pipe(10,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(11,"th",11),t.\u0275\u0275text(12),t.\u0275\u0275pipe(13,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(14,"th",11),t.\u0275\u0275text(15),t.\u0275\u0275pipe(16,"translate"),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(17,"tbody"),t.\u0275\u0275template(18,at,3,7,"tr",12),t.\u0275\u0275elementEnd()()()()),2&n){const e=t.\u0275\u0275nextContext().ngVar,o=t.\u0275\u0275nextContext();t.\u0275\u0275property("paginationOptions",o.config)("collectionSize",null==e||null==e.pageInfo?null:e.pageInfo.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),t.\u0275\u0275advance(6),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(7,9,"subscriptions.table.dso")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(10,11,"subscriptions.table.subscription_type")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(13,13,"subscriptions.table.subscription_frequency")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(16,15,"subscriptions.table.action")),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",null==e?null:e.page)}}function pt(n,s){1&n&&(t.\u0275\u0275elementStart(0,"ds-alert",14),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&n&&(t.\u0275\u0275property("type","alert-info"),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,2,"subscriptions.table.empty.message")," "))}function lt(n,s){if(1&n&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,rt,19,17,"ds-pagination",5),t.\u0275\u0275pipe(2,"async"),t.\u0275\u0275template(3,pt,3,4,"ds-alert",6),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275elementContainerEnd()),2&n){const e=s.ngVar,o=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",(null==e||null==e.pageInfo?null:e.pageInfo.totalElements)>0&&!t.\u0275\u0275pipeBind1(2,2,o.loading$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",0==(null==e||null==e.pageInfo?null:e.pageInfo.totalElements)&&!t.\u0275\u0275pipeBind1(4,4,o.loading$))}}let ct=(()=>{class n{constructor(e,o,a){this.paginationService=e,this.authService=o,this.subscriptionService=a,this.subscriptions$=new h.X((0,K.b)(new q.S,[])),this.config=Object.assign(new w.r,{id:"elp",pageSize:10,currentPage:1}),this.loading$=new h.X(!1),this.sub=null}ngOnInit(){this.ePersonId$=this.authService.getAuthenticatedUserFromStore().pipe((0,l.q)(1),(0,Q.U)(e=>e.id),(0,U.d)()),this.retrieveSubscriptions()}retrieveSubscriptions(){this.sub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe(H(this.ePersonId$),(0,Y.b)(()=>this.loading$.next(!0)),(0,J.w)(([e,o])=>this.subscriptionService.findByEPerson(o,{currentPage:e.currentPage,elementsPerPage:e.pageSize})),(0,tt.f1)()).subscribe(e=>{e.hasSucceeded&&this.subscriptions$.next(e.payload),this.loading$.next(!1)})}refresh(){(0,c.Uh)(this.sub)&&this.sub.unsubscribe(),this.retrieveSubscriptions()}ngOnDestroy(){(0,c.Uh)(this.sub)&&this.sub.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.\u0275\u0275directiveInject(k.N),t.\u0275\u0275directiveInject(_.e8),t.\u0275\u0275directiveInject(g.D))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["ds-subscriptions-page"]],decls:12,vars:9,consts:[[1,"container"],[1,"row"],[1,"col-md-12","m-40"],[4,"ngIf"],[4,"ngVar"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["data-test","empty-alert",3,"type",4,"ngIf"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","formats","data-test","subscription-table",1,"table","table-striped","table-hover"],["scope","col",2,"width","50%"],["scope","col"],["ds-subscription-view","",3,"dso","eperson","subscription","reload",4,"ngFor","ngForOf"],["ds-subscription-view","",3,"dso","eperson","subscription","reload"],["data-test","empty-alert",3,"type"]],template:function(e,o){1&e&&(t.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),t.\u0275\u0275text(4),t.\u0275\u0275pipe(5,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"div",1)(7,"div",2),t.\u0275\u0275template(8,st,1,0,"ds-themed-loading",3),t.\u0275\u0275pipe(9,"async"),t.\u0275\u0275template(10,lt,5,6,"ng-container",4),t.\u0275\u0275pipe(11,"async"),t.\u0275\u0275elementEnd()()()()()),2&e&&(t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(5,3,"subscriptions.title")),t.\u0275\u0275advance(4),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(9,5,o.loading$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngVar",t.\u0275\u0275pipeBind1(11,7,o.subscriptions$)))},dependencies:[r.sg,r.O5,et.w,nt.Z,it.Q,ot.g,v,r.Ov,d.X$]}),n})(),dt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=t.\u0275\u0275defineInjector({imports:[N,p.Bz.forChild([{path:"",data:{title:"subscriptions.title"},children:[{path:"",component:ct}]}])]}),n})()}}]);