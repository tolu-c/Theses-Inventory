"use strict";var __defProp=Object.defineProperty,__name=(target,value)=>__defProp(target,"name",{value,configurable:!0});exports.id=2987,exports.ids=[2987],exports.modules={42987:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ForgotPasswordFormComponent:()=>ForgotPasswordFormComponent});var _core_eperson_eperson_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(74708),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39373),rxjs_operators__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(96846),_core_auth_auth_actions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(56800),_core_shared_operators__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(53829),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(86209),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(4330),_ngrx_store__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(60857),_angular_router__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(16088),_angular_common__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(65159),_profile_page_profile_page_security_form_profile_page_security_form_component__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(41034);function ForgotPasswordFormComponent_div_0_Template(rf,ctx){if(1&rf){const _r2=_angular_core__WEBPACK_IMPORTED_MODULE_5__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_5__.TgZ(0,"div",1)(1,"h3",2),_angular_core__WEBPACK_IMPORTED_MODULE_5__._uU(2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.ALo(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.TgZ(4,"div",3)(5,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_5__._uU(6),_angular_core__WEBPACK_IMPORTED_MODULE_5__.ALo(7,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.TgZ(8,"div",5)(9,"div",6)(10,"div",7)(11,"label",8),_angular_core__WEBPACK_IMPORTED_MODULE_5__._uU(12),_angular_core__WEBPACK_IMPORTED_MODULE_5__.ALo(13,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.TgZ(14,"span",9),_angular_core__WEBPACK_IMPORTED_MODULE_5__._uU(15),_angular_core__WEBPACK_IMPORTED_MODULE_5__.ALo(16,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.qZA()()()()(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.TgZ(17,"div",3)(18,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_5__._uU(19),_angular_core__WEBPACK_IMPORTED_MODULE_5__.ALo(20,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.TgZ(21,"div",5)(22,"ds-profile-page-security-form",10),_angular_core__WEBPACK_IMPORTED_MODULE_5__.NdJ("isInvalid",__name(function($event){_angular_core__WEBPACK_IMPORTED_MODULE_5__.CHM(_r2);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_5__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_5__.KtG(ctx_r1.setInValid($event))},"ForgotPasswordFormComponent_div_0_Template_ds_profile_page_security_form_isInvalid_22_listener"))("passwordValue",__name(function($event){_angular_core__WEBPACK_IMPORTED_MODULE_5__.CHM(_r2);const ctx_r3=_angular_core__WEBPACK_IMPORTED_MODULE_5__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_5__.KtG(ctx_r3.setPasswordValue($event))},"ForgotPasswordFormComponent_div_0_Template_ds_profile_page_security_form_passwordValue_22_listener")),_angular_core__WEBPACK_IMPORTED_MODULE_5__.qZA()()(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.TgZ(23,"div",6)(24,"div",7)(25,"button",11),_angular_core__WEBPACK_IMPORTED_MODULE_5__.NdJ("click",__name(function(){_angular_core__WEBPACK_IMPORTED_MODULE_5__.CHM(_r2);const ctx_r4=_angular_core__WEBPACK_IMPORTED_MODULE_5__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_5__.KtG(ctx_r4.submit())},"ForgotPasswordFormComponent_div_0_Template_button_click_25_listener")),_angular_core__WEBPACK_IMPORTED_MODULE_5__._uU(26),_angular_core__WEBPACK_IMPORTED_MODULE_5__.ALo(27,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.qZA()()()()}if(2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_5__.oxw();_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Oqu(_angular_core__WEBPACK_IMPORTED_MODULE_5__.lcZ(3,9,"forgot-password.form.head")),_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(4),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Oqu(_angular_core__WEBPACK_IMPORTED_MODULE_5__.lcZ(7,11,"forgot-password.form.identification.header")),_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(6),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Oqu(_angular_core__WEBPACK_IMPORTED_MODULE_5__.lcZ(13,13,"forgot-password.form.identification.email")),_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(3),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Oqu(_angular_core__WEBPACK_IMPORTED_MODULE_5__.lcZ(16,15,ctx_r0.registration$).email),_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(4),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Oqu(_angular_core__WEBPACK_IMPORTED_MODULE_5__.lcZ(20,17,"forgot-password.form.card.security")),_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(3),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Q6J("passwordCanBeEmpty",!1)("FORM_PREFIX","forgot-password.form."),_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(3),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Q6J("disabled",ctx_r0.isInValid),_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Oqu(_angular_core__WEBPACK_IMPORTED_MODULE_5__.lcZ(27,19,"forgot-password.form.submit"))}}__name(ForgotPasswordFormComponent_div_0_Template,"ForgotPasswordFormComponent_div_0_Template");class ForgotPasswordFormComponent{constructor(ePersonDataService,translateService,notificationsService,store,router,route){this.ePersonDataService=ePersonDataService,this.translateService=translateService,this.notificationsService=notificationsService,this.store=store,this.router=router,this.route=route,this.isInValid=!0,this.NOTIFICATIONS_PREFIX="forgot-password.form.notification"}ngOnInit(){this.registration$=this.route.data.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.UI)(data=>data.registration),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_3__.Gp)()),this.registration$.subscribe(registration=>{this.email=registration.email,this.token=registration.token,this.user=registration.user})}setInValid($event){this.isInValid=$event}setPasswordValue($event){this.password=$event}submit(){this.isInValid||this.ePersonDataService.patchPasswordWithToken(this.user,this.token,this.password).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_3__.hC)()).subscribe(response=>{response.hasSucceeded?(this.notificationsService.success(this.translateService.instant(this.NOTIFICATIONS_PREFIX+".success.title"),this.translateService.instant(this.NOTIFICATIONS_PREFIX+".success.content")),this.store.dispatch(new _core_auth_auth_actions__WEBPACK_IMPORTED_MODULE_2__.zn(this.email,this.password)),this.router.navigate(["/home"])):this.notificationsService.error(this.translateService.instant(this.NOTIFICATIONS_PREFIX+".error.title"),response.errorMessage)})}}__name(ForgotPasswordFormComponent,"ForgotPasswordFormComponent"),ForgotPasswordFormComponent.\u0275fac=__name(function(t){return new(t||ForgotPasswordFormComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y36(_core_eperson_eperson_data_service__WEBPACK_IMPORTED_MODULE_0__.k),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y36(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_7__.sK),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y36(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__.T),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y36(_ngrx_store__WEBPACK_IMPORTED_MODULE_8__.yh),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y36(_angular_router__WEBPACK_IMPORTED_MODULE_9__.F0),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y36(_angular_router__WEBPACK_IMPORTED_MODULE_9__.gz))},"ForgotPasswordFormComponent_Factory"),ForgotPasswordFormComponent.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_5__.Xpm({type:ForgotPasswordFormComponent,selectors:[["ds-forgot-password-form"]],decls:2,vars:3,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"mb-4"],[1,"card","mb-4"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-12"],["for","email",1,"font-weight-bold"],["id","email"],[3,"passwordCanBeEmpty","FORM_PREFIX","isInvalid","passwordValue"],[1,"btn","btn-default","btn-primary",3,"disabled","click"]],template:__name(function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.YNc(0,ForgotPasswordFormComponent_div_0_Template,28,21,"div",0),_angular_core__WEBPACK_IMPORTED_MODULE_5__.ALo(1,"async")),2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_5__.Q6J("ngIf",_angular_core__WEBPACK_IMPORTED_MODULE_5__.lcZ(1,1,ctx.registration$))},"ForgotPasswordFormComponent_Template"),dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_10__.O5,_profile_page_profile_page_security_form_profile_page_security_form_component__WEBPACK_IMPORTED_MODULE_4__.V,_angular_common__WEBPACK_IMPORTED_MODULE_10__.Ov,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_7__.X$]})},41034:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{V:()=>ProfilePageSecurityFormComponent});var _angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(86209),_ng_dynamic_forms_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(49417),_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(59501),_core_eperson_eperson_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(74708),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39373),rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(96846),_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(53829),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(4330),_angular_common__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(65159),_angular_forms__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(32189),_shared_alert_alert_component__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(74369),_shared_form_form_component__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(23593);function ProfilePageSecurityFormComponent_ds_form_3_Template(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_5__._UZ(0,"ds-form",4),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_5__.oxw();_angular_core__WEBPACK_IMPORTED_MODULE_5__.Q6J("formId",ctx_r0.FORM_PREFIX)("formModel",ctx_r0.formModel)("formGroup",ctx_r0.formGroup)("displaySubmit",!1)("displayCancel",!1)}}function ProfilePageSecurityFormComponent_div_4_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.TgZ(0,"div",5),_angular_core__WEBPACK_IMPORTED_MODULE_5__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.ALo(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.qZA()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_5__.oxw();_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Oqu(_angular_core__WEBPACK_IMPORTED_MODULE_5__.lcZ(2,1,ctx_r1.FORM_PREFIX+"error.matching-passwords"))}}function ProfilePageSecurityFormComponent_div_5_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.TgZ(0,"div",6),_angular_core__WEBPACK_IMPORTED_MODULE_5__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.ALo(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.qZA()),2&rf){const ctx_r2=_angular_core__WEBPACK_IMPORTED_MODULE_5__.oxw();_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Oqu(_angular_core__WEBPACK_IMPORTED_MODULE_5__.lcZ(2,1,ctx_r2.FORM_PREFIX+"error.empty-password"))}}__name(ProfilePageSecurityFormComponent_ds_form_3_Template,"ProfilePageSecurityFormComponent_ds_form_3_Template"),__name(ProfilePageSecurityFormComponent_div_4_Template,"ProfilePageSecurityFormComponent_div_4_Template"),__name(ProfilePageSecurityFormComponent_div_5_Template,"ProfilePageSecurityFormComponent_div_5_Template");class ProfilePageSecurityFormComponent{constructor(formService,translate,epersonService,notificationsService){this.formService=formService,this.translate=translate,this.epersonService=epersonService,this.notificationsService=notificationsService,this.isInvalid=new _angular_core__WEBPACK_IMPORTED_MODULE_5__.vpe,this.passwordValue=new _angular_core__WEBPACK_IMPORTED_MODULE_5__.vpe,this.currentPasswordValue=new _angular_core__WEBPACK_IMPORTED_MODULE_5__.vpe,this.formModel=[new _ng_dynamic_forms_core__WEBPACK_IMPORTED_MODULE_6__.b1u({id:"password",name:"password",inputType:"password"}),new _ng_dynamic_forms_core__WEBPACK_IMPORTED_MODULE_6__.b1u({id:"passwordrepeat",name:"passwordrepeat",inputType:"password"})],this.passwordCanBeEmpty=!0,this.subs=[]}ngOnInit(){"profile.security.form."===this.FORM_PREFIX&&this.formModel.unshift(new _ng_dynamic_forms_core__WEBPACK_IMPORTED_MODULE_6__.b1u({id:"current-password",name:"current-password",inputType:"password",required:!0})),this.passwordCanBeEmpty?this.formGroup=this.formService.createFormGroup(this.formModel,{validators:[this.checkPasswordsEqual]}):this.formGroup=this.formService.createFormGroup(this.formModel,{validators:[this.checkPasswordsEqual,this.checkPasswordEmpty]}),this.updateFieldTranslations(),this.translate.onLangChange.subscribe(()=>{this.updateFieldTranslations()}),this.subs.push(this.formGroup.statusChanges.pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.ig)(300),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.UI)(status=>"VALID"!==status)).subscribe(status=>this.isInvalid.emit(status))),this.subs.push(this.formGroup.valueChanges.pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.ig)(300)).subscribe(valueChange=>{this.passwordValue.emit(valueChange.password),"profile.security.form."===this.FORM_PREFIX&&this.currentPasswordValue.emit(valueChange["current-password"])}))}updateFieldTranslations(){this.formModel.forEach(fieldModel=>{fieldModel.label=this.translate.instant(this.FORM_PREFIX+"label."+fieldModel.id)})}checkPasswordsEqual(group){return group.get("password").value===group.get("passwordrepeat").value?null:{notSame:!0}}checkPasswordEmpty(group){const pass=group.get("password").value;return(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__.xb)(pass)?{emptyPassword:!0}:null}ngOnDestroy(){this.subs.filter(sub=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__.Uh)(sub)).forEach(sub=>sub.unsubscribe())}}__name(ProfilePageSecurityFormComponent,"ProfilePageSecurityFormComponent"),ProfilePageSecurityFormComponent.\u0275fac=__name(function(t){return new(t||ProfilePageSecurityFormComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y36(_ng_dynamic_forms_core__WEBPACK_IMPORTED_MODULE_6__.w1X),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y36(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_9__.sK),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y36(_core_eperson_eperson_data_service__WEBPACK_IMPORTED_MODULE_0__.k),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y36(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__.T))},"ProfilePageSecurityFormComponent_Factory"),ProfilePageSecurityFormComponent.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_5__.Xpm({type:ProfilePageSecurityFormComponent,selectors:[["ds-profile-page-security-form"]],inputs:{passwordCanBeEmpty:"passwordCanBeEmpty",FORM_PREFIX:"FORM_PREFIX"},outputs:{isInvalid:"isInvalid",passwordValue:"passwordValue",currentPasswordValue:"currentPasswordValue"},decls:6,vars:7,consts:[[1,"mb-4",3,"type"],[3,"formId","formModel","formGroup","displaySubmit","displayCancel",4,"ngIf"],["id","notSame","class","container-fluid text-danger",4,"ngIf"],["id","emptyPassword","class","container-fluid text-danger",4,"ngIf"],[3,"formId","formModel","formGroup","displaySubmit","displayCancel"],["id","notSame",1,"container-fluid","text-danger"],["id","emptyPassword",1,"container-fluid","text-danger"]],template:__name(function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.TgZ(0,"ds-alert",0),_angular_core__WEBPACK_IMPORTED_MODULE_5__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.ALo(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.YNc(3,ProfilePageSecurityFormComponent_ds_form_3_Template,1,5,"ds-form",1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.YNc(4,ProfilePageSecurityFormComponent_div_4_Template,3,3,"div",2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.YNc(5,ProfilePageSecurityFormComponent_div_5_Template,3,3,"div",3)),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.Q6J("type","alert-info"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Oqu(_angular_core__WEBPACK_IMPORTED_MODULE_5__.lcZ(2,5,ctx.FORM_PREFIX+"info")),_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Q6J("ngIf",ctx.formModel),_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Q6J("ngIf",ctx.formGroup.hasError("notSame")),_angular_core__WEBPACK_IMPORTED_MODULE_5__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Q6J("ngIf",(ctx.formGroup.dirty||ctx.formGroup.touched)&&ctx.formGroup.hasError("emptyPassword")))},"ProfilePageSecurityFormComponent_Template"),dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_10__.O5,_angular_forms__WEBPACK_IMPORTED_MODULE_11__.JL,_angular_forms__WEBPACK_IMPORTED_MODULE_11__.sg,_shared_alert_alert_component__WEBPACK_IMPORTED_MODULE_3__.w,_shared_form_form_component__WEBPACK_IMPORTED_MODULE_4__.U,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_9__.X$],encapsulation:2})}};