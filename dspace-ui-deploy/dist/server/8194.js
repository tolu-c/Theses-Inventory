"use strict";var __defProp=Object.defineProperty,__name=(target,value)=>__defProp(target,"name",{value,configurable:!0});exports.id=8194,exports.ids=[8194],exports.modules={78194:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{EditCollectionPageModule:()=>EditCollectionPageModule});var common=__webpack_require__(65159),shared_module=__webpack_require__(47013),router=__webpack_require__(16088),cjs=__webpack_require__(93489),dso_name_service=__webpack_require__(17306),fade=__webpack_require__(65245),operators=__webpack_require__(96846),shared_operators=__webpack_require__(53829),dspace_object_type_model=__webpack_require__(70471),sort_options_model=__webpack_require__(12448),notifications_service=__webpack_require__(39373),item_data_service=__webpack_require__(22476),collection_data_service=__webpack_require__(761),empty_util=__webpack_require__(59501),my_dspace_page_component=__webpack_require__(14892),search_configuration_service=__webpack_require__(40370),paginated_search_options_model=__webpack_require__(81112),search_service=__webpack_require__(39185),follow_link_config_model=__webpack_require__(58090),feature_id=__webpack_require__(60676),core=__webpack_require__(86209),ngx_translate_core=__webpack_require__(4330),ng_bootstrap=__webpack_require__(23506),themed_search_form_component=__webpack_require__(6381),item_select_component=__webpack_require__(30867);const _c0=["tabs"];function CollectionItemMapperComponent_ng_template_18_Template(rf,ctx){if(1&rf){const _r4=core.EpF();core.TgZ(0,"div",10)(1,"ds-item-select",11),core.NdJ("confirm",__name(function($event){core.CHM(_r4);const ctx_r3=core.oxw();return core.KtG(ctx_r3.mapItems($event,!0))},"CollectionItemMapperComponent_ng_template_18_Template_ds_item_select_confirm_1_listener"))("cancel",__name(function(){core.CHM(_r4);const ctx_r5=core.oxw();return core.KtG(ctx_r5.onCancel())},"CollectionItemMapperComponent_ng_template_18_Template_ds_item_select_cancel_1_listener")),core.ALo(2,"async"),core.qZA()()}if(2&rf){const ctx_r1=core.oxw();let tmp_2_0;core.xp6(1),core.Q6J("key","browse")("dsoRD$",ctx_r1.collectionItemsRD$)("paginationOptions",null==(tmp_2_0=core.lcZ(2,7,ctx_r1.searchOptions$))?null:tmp_2_0.pagination)("confirmButton","collection.edit.item-mapper.remove")("cancelButton","collection.edit.item-mapper.cancel")("dangerConfirm",!0)("hideCollection",!0)}}function CollectionItemMapperComponent_ng_template_23_div_6_Template(rf,ctx){if(1&rf){const _r9=core.EpF();core.TgZ(0,"div")(1,"ds-item-select",17),core.NdJ("confirm",__name(function($event){core.CHM(_r9);const ctx_r8=core.oxw(2);return core.KtG(ctx_r8.mapItems($event))},"CollectionItemMapperComponent_ng_template_23_div_6_Template_ds_item_select_confirm_1_listener"))("cancel",__name(function(){core.CHM(_r9);const ctx_r10=core.oxw(2);return core.KtG(ctx_r10.onCancel())},"CollectionItemMapperComponent_ng_template_23_div_6_Template_ds_item_select_cancel_1_listener")),core.ALo(2,"async"),core.qZA()()}if(2&rf){const ctx_r6=core.oxw(2);let tmp_2_0;core.xp6(1),core.Q6J("key","map")("dsoRD$",ctx_r6.mappedItemsRD$)("paginationOptions",null==(tmp_2_0=core.lcZ(2,6,ctx_r6.searchOptions$))?null:tmp_2_0.pagination)("featureId",ctx_r6.FeatureIds.CanManageMappings)("confirmButton","collection.edit.item-mapper.confirm")("cancelButton","collection.edit.item-mapper.cancel")}}function CollectionItemMapperComponent_ng_template_23_div_7_Template(rf,ctx){1&rf&&(core.TgZ(0,"div",18),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.hij(" ",core.lcZ(2,1,"collection.edit.item-mapper.no-search")," "))}function CollectionItemMapperComponent_ng_template_23_Template(rf,ctx){if(1&rf){const _r12=core.EpF();core.TgZ(0,"div",12)(1,"div",13)(2,"ds-themed-search-form",14),core.NdJ("submitSearch",__name(function(){core.CHM(_r12);const ctx_r11=core.oxw();return core.KtG(ctx_r11.performedSearch=!0)},"CollectionItemMapperComponent_ng_template_23_Template_ds_themed_search_form_submitSearch_2_listener")),core.ALo(3,"async"),core.ALo(4,"async"),core.ALo(5,"translate"),core.qZA()()(),core.YNc(6,CollectionItemMapperComponent_ng_template_23_div_6_Template,3,8,"div",15),core.YNc(7,CollectionItemMapperComponent_ng_template_23_div_7_Template,3,3,"div",16)}if(2&rf){const ctx_r2=core.oxw();let tmp_0_0,tmp_1_0;core.xp6(2),core.Q6J("query",null==(tmp_0_0=core.lcZ(3,7,ctx_r2.searchOptions$))?null:tmp_0_0.query)("scope",null==(tmp_1_0=core.lcZ(4,9,ctx_r2.searchOptions$))?null:tmp_1_0.scope)("currentUrl","./")("inPlaceSearch",!0)("searchPlaceholder",core.lcZ(5,11,"collection.edit.item-mapper.search-form.placeholder")),core.xp6(4),core.Q6J("ngIf",ctx_r2.performedSearch),core.xp6(1),core.Q6J("ngIf",!ctx_r2.performedSearch)}}__name(CollectionItemMapperComponent_ng_template_18_Template,"CollectionItemMapperComponent_ng_template_18_Template"),__name(CollectionItemMapperComponent_ng_template_23_div_6_Template,"CollectionItemMapperComponent_ng_template_23_div_6_Template"),__name(CollectionItemMapperComponent_ng_template_23_div_7_Template,"CollectionItemMapperComponent_ng_template_23_div_7_Template"),__name(CollectionItemMapperComponent_ng_template_23_Template,"CollectionItemMapperComponent_ng_template_23_Template");const _c1=__name(function(a0){return{name:a0}},"_c1");class CollectionItemMapperComponent{constructor(route,router2,searchConfigService,searchService,notificationsService,itemDataService,collectionDataService,translateService,dsoNameService){this.route=route,this.router=router2,this.searchConfigService=searchConfigService,this.searchService=searchService,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.collectionDataService=collectionDataService,this.translateService=translateService,this.dsoNameService=dsoNameService,this.FeatureIds=feature_id.i,this.defaultSortOptions=new sort_options_model.o("dc.title",sort_options_model.S.ASC),this.performedSearch=!1}ngOnInit(){this.collectionRD$=this.route.parent.data.pipe((0,operators.UI)(data=>data.dso),(0,shared_operators.xw)()),this.collectionName$=this.collectionRD$.pipe((0,operators.UI)(rd=>this.dsoNameService.getName(rd.payload))),this.searchOptions$=this.searchConfigService.paginatedSearchOptions,this.loadItemLists()}loadItemLists(){this.shouldUpdate$=new cjs.BehaviorSubject(!0);const collectionAndOptions$=(0,cjs.combineLatest)(this.collectionRD$,this.searchOptions$,this.shouldUpdate$);this.collectionItemsRD$=collectionAndOptions$.pipe((0,operators.wt)(([collectionRD,options,shouldUpdate])=>(!0===shouldUpdate&&this.shouldUpdate$.next(!1),this.itemDataService.findListByHref(collectionRD.payload._links.mappedItems.href,Object.assign(options,{sort:this.defaultSortOptions}),!shouldUpdate,!1,(0,follow_link_config_model.l)("owningCollection")).pipe((0,shared_operators.g1)())))),this.mappedItemsRD$=collectionAndOptions$.pipe((0,operators.wt)(([collectionRD,options,shouldUpdate])=>this.searchService.search(Object.assign(new paginated_search_options_model.t(options),{query:this.buildQuery(collectionRD.payload.id,options.query),scope:void 0,dsoTypes:[dspace_object_type_model.h.ITEM],sort:this.defaultSortOptions}),1e4,void 0,void 0,(0,follow_link_config_model.l)("owningCollection")).pipe((0,shared_operators.Ie)(),(0,operators.O4)(void 0))))}mapItems(ids,remove){const responses$=this.collectionRD$.pipe((0,shared_operators.xw)(),(0,operators.UI)(collectionRD=>collectionRD.payload),(0,operators.wt)(collection=>(0,cjs.combineLatest)(ids.map(id=>remove?this.itemDataService.removeMappingFromCollection(id,collection.id).pipe((0,shared_operators.hC)()):this.itemDataService.mapToCollection(id,collection._links.self.href).pipe((0,shared_operators.hC)())))));this.showNotifications(responses$,remove)}showNotifications(responses$,remove){const messageInsertion=remove?"unmap":"map";responses$.subscribe(responses=>{const successful=responses.filter(response=>response.hasSucceeded),unsuccessful=responses.filter(response=>response.hasFailed);successful.length>0&&((0,cjs.combineLatest)(this.translateService.get(`collection.edit.item-mapper.notifications.${messageInsertion}.success.head`),this.translateService.get(`collection.edit.item-mapper.notifications.${messageInsertion}.success.content`,{amount:successful.length})).subscribe(([head,content])=>{this.notificationsService.success(head,content)}),this.shouldUpdate$.next(!0)),unsuccessful.length>0&&(0,cjs.combineLatest)(this.translateService.get(`collection.edit.item-mapper.notifications.${messageInsertion}.error.head`),this.translateService.get(`collection.edit.item-mapper.notifications.${messageInsertion}.error.content`,{amount:unsuccessful.length})).subscribe(([head,content])=>{this.notificationsService.error(head,content)}),this.switchToFirstTab()})}tabChange(event){this.performedSearch=!1,this.router.navigateByUrl(this.getCurrentUrl())}getCurrentUrl(){return this.router.url.indexOf("?")>-1?this.router.url.substring(0,this.router.url.indexOf("?")):this.router.url}buildQuery(collectionId,query){const excludeColQuery=`-location.coll:"${collectionId}"`;return(0,empty_util.UE)(query)?`${excludeColQuery} AND ${query}`:excludeColQuery}switchToFirstTab(){this.tabs.select("browseTab")}onCancel(){this.collectionRD$.pipe((0,shared_operators.xw)(),(0,shared_operators.xe)(),(0,operators.qn)(1)).subscribe(collection=>{this.router.navigate(["/collections/",collection.id])})}}__name(CollectionItemMapperComponent,"CollectionItemMapperComponent"),CollectionItemMapperComponent.\u0275fac=__name(function(t){return new(t||CollectionItemMapperComponent)(core.Y36(router.gz),core.Y36(router.F0),core.Y36(my_dspace_page_component.SEARCH_CONFIG_SERVICE),core.Y36(search_service.o),core.Y36(notifications_service.T),core.Y36(item_data_service.S),core.Y36(collection_data_service.W),core.Y36(ngx_translate_core.sK),core.Y36(dso_name_service._))},"CollectionItemMapperComponent_Factory"),CollectionItemMapperComponent.\u0275cmp=core.Xpm({type:CollectionItemMapperComponent,selectors:[["ds-collection-item-mapper"]],viewQuery:__name(function(rf,ctx){if(1&rf&&core.Gf(_c0,5),2&rf){let _t;core.iGM(_t=core.CRH())&&(ctx.tabs=_t.first)}},"CollectionItemMapperComponent_Query"),features:[core._Bn([{provide:my_dspace_page_component.SEARCH_CONFIG_SERVICE,useClass:search_configuration_service.U}])],decls:25,vars:24,consts:[[1,"container"],[1,"row"],[1,"col-12"],["id","collection-name",3,"innerHTML"],["ngbNav","",1,"nav-tabs",3,"destroyOnHide","navChange"],["tabs","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavOutlet"],[1,"mt-2"],[1,"mt-2",3,"key","dsoRD$","paginationOptions","confirmButton","cancelButton","dangerConfirm","hideCollection","confirm","cancel"],[1,"row","mt-2"],[1,"col-12","col-lg-6"],["id","search-form",3,"query","scope","currentUrl","inPlaceSearch","searchPlaceholder","submitSearch"],[4,"ngIf"],["class","alert alert-info w-100","role","alert",4,"ngIf"],[1,"mt-2",3,"key","dsoRD$","paginationOptions","featureId","confirmButton","cancelButton","confirm","cancel"],["role","alert",1,"alert","alert-info","w-100"]],template:__name(function(rf,ctx){if(1&rf&&(core.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),core._uU(4),core.ALo(5,"translate"),core.qZA(),core._UZ(6,"p",3),core.ALo(7,"translate"),core.ALo(8,"async"),core.TgZ(9,"p"),core._uU(10),core.ALo(11,"translate"),core.qZA(),core.TgZ(12,"ul",4,5),core.NdJ("navChange",__name(function($event){return ctx.tabChange($event)},"CollectionItemMapperComponent_Template_ul_navChange_12_listener")),core.TgZ(14,"li",6)(15,"a",7),core._uU(16),core.ALo(17,"translate"),core.qZA(),core.YNc(18,CollectionItemMapperComponent_ng_template_18_Template,3,9,"ng-template",8),core.qZA(),core.TgZ(19,"li",6)(20,"a",7),core._uU(21),core.ALo(22,"translate"),core.qZA(),core.YNc(23,CollectionItemMapperComponent_ng_template_23_Template,8,13,"ng-template",8),core.qZA()(),core._UZ(24,"div",9),core.qZA()()()),2&rf){const _r0=core.MAs(13);core.xp6(4),core.Oqu(core.lcZ(5,9,"collection.edit.item-mapper.head")),core.xp6(2),core.Q6J("innerHTML",core.xi3(7,11,"collection.edit.item-mapper.collection",core.VKq(22,_c1,core.lcZ(8,14,ctx.collectionName$))),core.oJD),core.xp6(4),core.Oqu(core.lcZ(11,16,"collection.edit.item-mapper.description")),core.xp6(2),core.Q6J("destroyOnHide",!0),core.xp6(2),core.Q6J("ngbNavItem","browseTab"),core.xp6(2),core.Oqu(core.lcZ(17,18,"collection.edit.item-mapper.tabs.browse")),core.xp6(3),core.Q6J("ngbNavItem","mapTab"),core.xp6(2),core.Oqu(core.lcZ(22,20,"collection.edit.item-mapper.tabs.map")),core.xp6(3),core.Q6J("ngbNavOutlet",_r0)}},"CollectionItemMapperComponent_Template"),dependencies:[common.O5,ng_bootstrap.uN,ng_bootstrap.Pz,ng_bootstrap.nv,ng_bootstrap.Vx,ng_bootstrap.tO,themed_search_form_component.p,item_select_component.p,common.Ov,ngx_translate_core.X$],data:{animation:[fade.Ji,fade.Ic]},changeDetection:0});var edit_comcol_page_component=__webpack_require__(12086),collection_page_routing_paths=__webpack_require__(67328);const edit_collection_page_component_c0=__name(function(a0){return{active:a0}},"edit_collection_page_component_c0"),edit_collection_page_component_c1=__name(function(a0){return[a0]},"edit_collection_page_component_c1");function EditCollectionPageComponent_li_15_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"li",13)(1,"a",14),core._uU(2),core.ALo(3,"translate"),core.qZA()()),2&rf){const page_r2=ctx.$implicit,ctx_r0=core.oxw();core.xp6(1),core.Q6J("ngClass",core.VKq(5,edit_collection_page_component_c0,page_r2===ctx_r0.currentPage))("routerLink",core.VKq(7,edit_collection_page_component_c1,"./"+page_r2)),core.xp6(1),core.hij(" ",core.lcZ(3,3,ctx_r0.type+".edit.tabs."+page_r2+".head")," ")}}function EditCollectionPageComponent_a_20_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"a",15),core.ALo(1,"async"),core._UZ(2,"i",16),core._uU(3),core.ALo(4,"translate"),core.qZA()),2&rf){const ctx_r1=core.oxw();let tmp_0_0;core.Q6J("routerLink",ctx_r1.getPageUrl(null==(tmp_0_0=core.lcZ(1,2,ctx_r1.dsoRD$))?null:tmp_0_0.payload)),core.xp6(3),core.hij(" ",core.lcZ(4,4,ctx_r1.type+".edit.return")," ")}}__name(EditCollectionPageComponent_li_15_Template,"EditCollectionPageComponent_li_15_Template"),__name(EditCollectionPageComponent_a_20_Template,"EditCollectionPageComponent_a_20_Template");class EditCollectionPageComponent extends edit_comcol_page_component.x{constructor(router2,route){super(router2,route),this.router=router2,this.route=route,this.type="collection"}getPageUrl(collection){return(0,collection_page_routing_paths.MI)(collection.id)}}__name(EditCollectionPageComponent,"EditCollectionPageComponent"),EditCollectionPageComponent.\u0275fac=__name(function(t){return new(t||EditCollectionPageComponent)(core.Y36(router.F0),core.Y36(router.gz))},"EditCollectionPageComponent_Factory"),EditCollectionPageComponent.\u0275cmp=core.Xpm({type:EditCollectionPageComponent,selectors:[["ds-edit-collection"]],features:[core.qOj],decls:21,vars:11,consts:[[1,"container"],[1,"row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom"],[1,"btn","btn-danger",3,"routerLink"],[1,"fas","fa-trash"],[1,"pt-2"],[1,"nav","nav-tabs","justify-content-start","mb-2"],["class","nav-item",4,"ngFor","ngForOf"],[1,"tab-pane","active"],[1,"mb-4"],[1,"col-12","text-right"],["class","btn btn-outline-secondary",3,"routerLink",4,"ngIf"],[1,"nav-item"],[1,"nav-link",3,"ngClass","routerLink"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"fas","fa-arrow-left"]],template:__name(function(rf,ctx){if(1&rf&&(core.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),core._uU(5),core.ALo(6,"translate"),core.qZA(),core.TgZ(7,"div")(8,"a",4),core.ALo(9,"async"),core._UZ(10,"i",5),core._uU(11),core.ALo(12,"translate"),core.qZA()()(),core.TgZ(13,"div",6)(14,"ul",7),core.YNc(15,EditCollectionPageComponent_li_15_Template,4,9,"li",8),core.qZA(),core.TgZ(16,"div",9)(17,"div",10),core._UZ(18,"router-outlet"),core.qZA(),core.TgZ(19,"div",11),core.YNc(20,EditCollectionPageComponent_a_20_Template,5,6,"a",12),core.qZA()()()()()()),2&rf){let tmp_1_0;core.xp6(5),core.Oqu(core.lcZ(6,5,ctx.type+".edit.head")),core.xp6(3),core.Q6J("routerLink",("community"===ctx.type?"/communities/":"/collections/")+(null==(tmp_1_0=core.lcZ(9,7,ctx.dsoRD$))?null:tmp_1_0.payload.uuid)+"/delete"),core.xp6(3),core.hij(" ",core.lcZ(12,9,ctx.type+".edit.delete"),""),core.xp6(4),core.Q6J("ngForOf",ctx.pages),core.xp6(5),core.Q6J("ngIf",!ctx.hideReturnButton)}},"EditCollectionPageComponent_Template"),dependencies:[common.mk,common.sg,common.O5,router.lC,router.rH,common.Ov,ngx_translate_core.X$],encapsulation:2});var comcol_metadata_component=__webpack_require__(90921),collection_model=__webpack_require__(37894),item_template_data_service=__webpack_require__(3438),item_model=__webpack_require__(57324),request_service=__webpack_require__(91751),var_directive=__webpack_require__(61562),collection_form_component=__webpack_require__(96835);function CollectionMetadataComponent_div_0_button_5_Template(rf,ctx){if(1&rf){const _r6=core.EpF();core.TgZ(0,"button",7),core.NdJ("click",__name(function(){core.CHM(_r6);const ctx_r5=core.oxw(2);return core.KtG(ctx_r5.addItemTemplate())},"CollectionMetadataComponent_div_0_button_5_Template_button_click_0_listener")),core._UZ(1,"i",8),core.TgZ(2,"span",9),core._uU(3),core.ALo(4,"translate"),core.qZA()()}2&rf&&(core.xp6(3),core.hij("\xa0",core.lcZ(4,1,"collection.edit.template.add-button"),""))}function CollectionMetadataComponent_div_0_button_6_Template(rf,ctx){if(1&rf){const _r8=core.EpF();core.TgZ(0,"button",10),core.NdJ("click",__name(function(){core.CHM(_r8);const ctx_r7=core.oxw(2);return core.KtG(ctx_r7.deleteItemTemplate())},"CollectionMetadataComponent_div_0_button_6_Template_button_click_0_listener")),core._UZ(1,"i",11),core.TgZ(2,"span",9),core._uU(3),core.ALo(4,"translate"),core.qZA()()}2&rf&&(core.xp6(3),core.hij("\xa0",core.lcZ(4,1,"collection.edit.template.delete-button"),""))}function CollectionMetadataComponent_div_0_button_7_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"button",12),core.ALo(1,"async"),core._UZ(2,"i",13),core.TgZ(3,"span",9),core._uU(4),core.ALo(5,"translate"),core.qZA()()),2&rf){const ctx_r4=core.oxw(2);let tmp_0_0;core.Q6J("routerLink","/collections/"+(null==(tmp_0_0=core.lcZ(1,2,ctx_r4.dsoRD$))?null:tmp_0_0.payload.uuid)+"/itemtemplate"),core.xp6(4),core.hij("\xa0",core.lcZ(5,4,"collection.edit.template.edit-button"),"")}}function CollectionMetadataComponent_div_0_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",2)(1,"label"),core._uU(2),core.ALo(3,"translate"),core.qZA(),core.TgZ(4,"div",3),core.YNc(5,CollectionMetadataComponent_div_0_button_5_Template,5,3,"button",4),core.YNc(6,CollectionMetadataComponent_div_0_button_6_Template,5,3,"button",5),core.YNc(7,CollectionMetadataComponent_div_0_button_7_Template,6,6,"button",6),core.qZA()()),2&rf){const itemTemplateRD_r1=ctx.ngVar;core.xp6(2),core.Oqu(core.lcZ(3,4,"collection.edit.template.label")),core.xp6(3),core.Q6J("ngIf",!(null!=itemTemplateRD_r1&&itemTemplateRD_r1.payload)),core.xp6(1),core.Q6J("ngIf",null==itemTemplateRD_r1?null:itemTemplateRD_r1.payload),core.xp6(1),core.Q6J("ngIf",null==itemTemplateRD_r1?null:itemTemplateRD_r1.payload)}}__name(CollectionMetadataComponent_div_0_button_5_Template,"CollectionMetadataComponent_div_0_button_5_Template"),__name(CollectionMetadataComponent_div_0_button_6_Template,"CollectionMetadataComponent_div_0_button_6_Template"),__name(CollectionMetadataComponent_div_0_button_7_Template,"CollectionMetadataComponent_div_0_button_7_Template"),__name(CollectionMetadataComponent_div_0_Template,"CollectionMetadataComponent_div_0_Template");class CollectionMetadataComponent extends comcol_metadata_component.Z{constructor(collectionDataService,itemTemplateService,router2,route,notificationsService,translate,requestService,chd){super(collectionDataService,router2,route,notificationsService,translate),this.collectionDataService=collectionDataService,this.itemTemplateService=itemTemplateService,this.router=router2,this.route=route,this.notificationsService=notificationsService,this.translate=translate,this.requestService=requestService,this.chd=chd,this.frontendURL="/collections/",this.type=collection_model.F.type}ngOnInit(){this.router.events.subscribe(event=>{(event instanceof router.m2||event instanceof router.Xs&&event.routerEvent instanceof router.m2)&&(super.ngOnInit(),this.initTemplateItem(),this.chd.detectChanges())})}initTemplateItem(){this.itemTemplateRD$=this.dsoRD$.pipe((0,shared_operators.Gp)(),(0,operators.wt)(collection=>this.itemTemplateService.findByCollectionID(collection.uuid)))}addItemTemplate(){const collection$=this.dsoRD$.pipe((0,shared_operators.Gp)()),template$=collection$.pipe((0,operators.wt)(collection=>this.itemTemplateService.createByCollectionID(new item_model.c,collection.uuid).pipe((0,shared_operators.Gp)()))),templateHref$=collection$.pipe((0,operators.wt)(collection=>this.itemTemplateService.getCollectionEndpoint(collection.id)));(0,cjs.combineLatest)(collection$,template$,templateHref$).subscribe(([collection,template,templateHref])=>{this.requestService.setStaleByHrefSubstring(templateHref),this.router.navigate([(0,collection_page_routing_paths.$X)(collection.uuid)])})}deleteItemTemplate(){this.dsoRD$.pipe((0,shared_operators.Gp)(),(0,operators.wt)(collection=>this.itemTemplateService.findByCollectionID(collection.uuid)),(0,shared_operators.Gp)(),(0,operators.wt)(template=>this.itemTemplateService.delete(template.uuid)),(0,shared_operators.hC)(),(0,operators.UI)(response=>(0,empty_util.Uh)(response)&&response.hasSucceeded)).subscribe(success=>{success?this.notificationsService.success(null,this.translate.get("collection.edit.template.notifications.delete.success")):this.notificationsService.error(null,this.translate.get("collection.edit.template.notifications.delete.error")),this.initTemplateItem()})}}__name(CollectionMetadataComponent,"CollectionMetadataComponent"),CollectionMetadataComponent.\u0275fac=__name(function(t){return new(t||CollectionMetadataComponent)(core.Y36(collection_data_service.W),core.Y36(item_template_data_service.w),core.Y36(router.F0),core.Y36(router.gz),core.Y36(notifications_service.T),core.Y36(ngx_translate_core.sK),core.Y36(request_service.s),core.Y36(core.sBO))},"CollectionMetadataComponent_Factory"),CollectionMetadataComponent.\u0275cmp=core.Xpm({type:CollectionMetadataComponent,selectors:[["ds-collection-metadata"]],features:[core.qOj],decls:4,vars:6,consts:[["class","container-fluid mb-2",4,"ngVar"],[3,"dso","submitForm","back","finish"],[1,"container-fluid","mb-2"],[1,"button-row","space-children-mr"],["class","btn btn-success",3,"click",4,"ngIf"],["class","btn btn-danger",3,"click",4,"ngIf"],["class","btn btn-primary",3,"routerLink",4,"ngIf"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],[1,"btn","btn-danger",3,"click"],[1,"fas","fa-trash-alt"],[1,"btn","btn-primary",3,"routerLink"],[1,"fas","fa-edit"]],template:__name(function(rf,ctx){if(1&rf&&(core.YNc(0,CollectionMetadataComponent_div_0_Template,8,6,"div",0),core.ALo(1,"async"),core.TgZ(2,"ds-collection-form",1),core.NdJ("submitForm",__name(function($event){return ctx.onSubmit($event)},"CollectionMetadataComponent_Template_ds_collection_form_submitForm_2_listener"))("back",__name(function(){return ctx.navigateToHomePage()},"CollectionMetadataComponent_Template_ds_collection_form_back_2_listener"))("finish",__name(function(){return ctx.navigateToHomePage()},"CollectionMetadataComponent_Template_ds_collection_form_finish_2_listener")),core.ALo(3,"async"),core.qZA()),2&rf){let tmp_1_0;core.Q6J("ngVar",core.lcZ(1,2,ctx.itemTemplateRD$)),core.xp6(2),core.Q6J("dso",null==(tmp_1_0=core.lcZ(3,4,ctx.dsoRD$))?null:tmp_1_0.payload)}},"CollectionMetadataComponent_Template"),dependencies:[common.O5,router.rH,var_directive.g,collection_form_component.L,common.Ov,ngx_translate_core.X$],encapsulation:2});var comcol_role_component=__webpack_require__(47264);function CollectionRolesComponent_ds_comcol_role_0_Template(rf,ctx){if(1&rf&&(core._UZ(0,"ds-comcol-role",1),core.ALo(1,"async")),2&rf){const comcolRole_r1=ctx.$implicit,ctx_r0=core.oxw();core.Q6J("dso",core.lcZ(1,2,ctx_r0.collection$))("comcolRole",comcolRole_r1)}}__name(CollectionRolesComponent_ds_comcol_role_0_Template,"CollectionRolesComponent_ds_comcol_role_0_Template");class CollectionRolesComponent{constructor(route){this.route=route}ngOnInit(){this.dsoRD$=this.route.parent.data.pipe((0,operators.Ps)(),(0,operators.UI)(data=>data.dso)),this.collection$=this.dsoRD$.pipe((0,shared_operators.xw)(),(0,shared_operators.xe)()),this.comcolRoles$=this.collection$.pipe((0,operators.UI)(collection=>{let workflowGroups=(0,empty_util.Uh)(collection._links.workflowGroups)?collection._links.workflowGroups:[];return Array.isArray(workflowGroups)||(workflowGroups=[workflowGroups]),[{name:"collection-admin",href:collection._links.adminGroup.href},{name:"submitters",href:collection._links.submittersGroup.href},{name:"item_read",href:collection._links.itemReadGroup.href},{name:"bitstream_read",href:collection._links.bitstreamReadGroup.href},...workflowGroups]}))}}__name(CollectionRolesComponent,"CollectionRolesComponent"),CollectionRolesComponent.\u0275fac=__name(function(t){return new(t||CollectionRolesComponent)(core.Y36(router.gz))},"CollectionRolesComponent_Factory"),CollectionRolesComponent.\u0275cmp=core.Xpm({type:CollectionRolesComponent,selectors:[["ds-collection-roles"]],decls:2,vars:3,consts:[[3,"dso","comcolRole",4,"ngFor","ngForOf"],[3,"dso","comcolRole"]],template:__name(function(rf,ctx){1&rf&&(core.YNc(0,CollectionRolesComponent_ds_comcol_role_0_Template,2,4,"ds-comcol-role",0),core.ALo(1,"async")),2&rf&&core.Q6J("ngForOf",core.lcZ(1,1,ctx.comcolRoles$))},"CollectionRolesComponent_Template"),dependencies:[common.sg,comcol_role_component.b,common.Ov],encapsulation:2});var abstract_trackable_component=__webpack_require__(98894),fesm2020_core=__webpack_require__(49417),object_updates_service=__webpack_require__(1086),content_source_model=__webpack_require__(61254),cloneDeep=__webpack_require__(80115),cloneDeep_default=__webpack_require__.n(cloneDeep),environment=__webpack_require__(91602),fesm2020_forms=__webpack_require__(32189),themed_loading_component=__webpack_require__(24442),form_component=__webpack_require__(23593),script_data_service=__webpack_require__(30959),process_data_service=__webpack_require__(73616),process_status_model=__webpack_require__(76396),bitstream_data_service=__webpack_require__(83167),content_source_set_serializer=__webpack_require__(11598),http=__webpack_require__(8280);function CollectionSourceControlsComponent_div_0_div_1_button_31_Template(rf,ctx){if(1&rf){const _r11=core.EpF();core.TgZ(0,"button",8),core.NdJ("click",__name(function(){core.CHM(_r11);const contentSource_r1=core.oxw(2).ngVar,ctx_r9=core.oxw();return core.KtG(ctx_r9.testConfiguration(contentSource_r1))},"CollectionSourceControlsComponent_div_0_div_1_button_31_Template_button_click_0_listener")),core.TgZ(1,"span"),core._uU(2),core.ALo(3,"translate"),core.qZA()()}if(2&rf){const ctx_r3=core.oxw(3);core.Q6J("disabled",!ctx_r3.isEnabled),core.xp6(2),core.Oqu(core.lcZ(3,2,"collection.source.controls.test.submit"))}}function CollectionSourceControlsComponent_div_0_div_1_button_33_Template(rf,ctx){1&rf&&(core.TgZ(0,"button",9),core._UZ(1,"span",10),core.TgZ(2,"span"),core._uU(3),core.ALo(4,"translate"),core.qZA()()),2&rf&&(core.Q6J("disabled",!0),core.xp6(3),core.Oqu(core.lcZ(4,2,"collection.source.controls.test.running")))}function CollectionSourceControlsComponent_div_0_div_1_button_35_Template(rf,ctx){if(1&rf){const _r13=core.EpF();core.TgZ(0,"button",11),core.NdJ("click",__name(function(){core.CHM(_r13);const ctx_r12=core.oxw(3);return core.KtG(ctx_r12.importNow())},"CollectionSourceControlsComponent_div_0_div_1_button_35_Template_button_click_0_listener")),core.TgZ(1,"span",12),core._uU(2),core.ALo(3,"translate"),core.qZA()()}if(2&rf){const ctx_r5=core.oxw(3);core.Q6J("disabled",!ctx_r5.isEnabled),core.xp6(2),core.Oqu(core.lcZ(3,2,"collection.source.controls.import.submit"))}}function CollectionSourceControlsComponent_div_0_div_1_button_37_Template(rf,ctx){1&rf&&(core.TgZ(0,"button",13),core._UZ(1,"span",10),core.TgZ(2,"span",12),core._uU(3),core.ALo(4,"translate"),core.qZA()()),2&rf&&(core.Q6J("disabled",!0),core.xp6(3),core.Oqu(core.lcZ(4,2,"collection.source.controls.import.running")))}function CollectionSourceControlsComponent_div_0_div_1_button_39_Template(rf,ctx){if(1&rf){const _r15=core.EpF();core.TgZ(0,"button",11),core.NdJ("click",__name(function(){core.CHM(_r15);const ctx_r14=core.oxw(3);return core.KtG(ctx_r14.resetAndReimport())},"CollectionSourceControlsComponent_div_0_div_1_button_39_Template_button_click_0_listener")),core.TgZ(1,"span",12),core._uU(2),core.ALo(3,"translate"),core.qZA()()}if(2&rf){const ctx_r7=core.oxw(3);core.Q6J("disabled",!ctx_r7.isEnabled),core.xp6(2),core.hij("\xa0",core.lcZ(3,2,"collection.source.controls.reset.submit"),"")}}function CollectionSourceControlsComponent_div_0_div_1_button_41_Template(rf,ctx){1&rf&&(core.TgZ(0,"button",13),core._UZ(1,"span",10),core.TgZ(2,"span",12),core._uU(3),core.ALo(4,"translate"),core.qZA()()),2&rf&&(core.Q6J("disabled",!0),core.xp6(3),core.hij("\xa0",core.lcZ(4,2,"collection.source.controls.reset.running"),""))}function CollectionSourceControlsComponent_div_0_div_1_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",2)(1,"h4"),core._uU(2),core.ALo(3,"translate"),core.qZA(),core.TgZ(4,"div")(5,"span",3),core._uU(6),core.ALo(7,"translate"),core.qZA(),core.TgZ(8,"span"),core._uU(9),core.qZA()(),core.TgZ(10,"div")(11,"span",3),core._uU(12),core.ALo(13,"translate"),core.qZA(),core.TgZ(14,"span"),core._uU(15),core.ALo(16,"translate"),core.qZA()(),core.TgZ(17,"div")(18,"span",3),core._uU(19),core.ALo(20,"translate"),core.qZA(),core.TgZ(21,"span"),core._uU(22),core.ALo(23,"translate"),core.qZA()(),core.TgZ(24,"div")(25,"span",3),core._uU(26),core.ALo(27,"translate"),core.qZA(),core.TgZ(28,"span"),core._uU(29),core.ALo(30,"translate"),core.qZA()(),core.YNc(31,CollectionSourceControlsComponent_div_0_div_1_button_31_Template,4,4,"button",4),core.ALo(32,"async"),core.YNc(33,CollectionSourceControlsComponent_div_0_div_1_button_33_Template,5,4,"button",5),core.ALo(34,"async"),core.YNc(35,CollectionSourceControlsComponent_div_0_div_1_button_35_Template,4,4,"button",6),core.ALo(36,"async"),core.YNc(37,CollectionSourceControlsComponent_div_0_div_1_button_37_Template,5,4,"button",7),core.ALo(38,"async"),core.YNc(39,CollectionSourceControlsComponent_div_0_div_1_button_39_Template,4,4,"button",6),core.ALo(40,"async"),core.YNc(41,CollectionSourceControlsComponent_div_0_div_1_button_41_Template,5,4,"button",7),core.ALo(42,"async"),core.qZA()),2&rf){const contentSource_r1=core.oxw().ngVar,ctx_r2=core.oxw();core.xp6(2),core.Oqu(core.lcZ(3,15,"collection.source.controls.head")),core.xp6(4),core.Oqu(core.lcZ(7,17,"collection.source.controls.harvest.status")),core.xp6(3),core.Oqu(null==contentSource_r1?null:contentSource_r1.harvestStatus),core.xp6(3),core.Oqu(core.lcZ(13,19,"collection.source.controls.harvest.start")),core.xp6(3),core.Oqu(null!=contentSource_r1&&contentSource_r1.harvestStartTime?null==contentSource_r1?null:contentSource_r1.harvestStartTime:core.lcZ(16,21,"collection.source.controls.harvest.no-information")),core.xp6(4),core.Oqu(core.lcZ(20,23,"collection.source.controls.harvest.last")),core.xp6(3),core.Oqu(null!=contentSource_r1&&contentSource_r1.lastHarvested?null==contentSource_r1?null:contentSource_r1.lastHarvested:core.lcZ(23,25,"collection.source.controls.harvest.no-information")),core.xp6(4),core.Oqu(core.lcZ(27,27,"collection.source.controls.harvest.message")),core.xp6(3),core.Oqu(null!=contentSource_r1&&contentSource_r1.message?null==contentSource_r1?null:contentSource_r1.message:core.lcZ(30,29,"collection.source.controls.harvest.no-information")),core.xp6(2),core.Q6J("ngIf",!core.lcZ(32,31,ctx_r2.testConfigRunning$)),core.xp6(2),core.Q6J("ngIf",core.lcZ(34,33,ctx_r2.testConfigRunning$)),core.xp6(2),core.Q6J("ngIf",!core.lcZ(36,35,ctx_r2.importRunning$)),core.xp6(2),core.Q6J("ngIf",core.lcZ(38,37,ctx_r2.importRunning$)),core.xp6(2),core.Q6J("ngIf",!core.lcZ(40,39,ctx_r2.reImportRunning$)),core.xp6(2),core.Q6J("ngIf",core.lcZ(42,41,ctx_r2.reImportRunning$))}}function CollectionSourceControlsComponent_div_0_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div"),core.YNc(1,CollectionSourceControlsComponent_div_0_div_1_Template,43,43,"div",1),core.qZA()),2&rf){const ctx_r0=core.oxw();core.xp6(1),core.Q6J("ngIf",ctx_r0.shouldShow)}}__name(CollectionSourceControlsComponent_div_0_div_1_button_31_Template,"CollectionSourceControlsComponent_div_0_div_1_button_31_Template"),__name(CollectionSourceControlsComponent_div_0_div_1_button_33_Template,"CollectionSourceControlsComponent_div_0_div_1_button_33_Template"),__name(CollectionSourceControlsComponent_div_0_div_1_button_35_Template,"CollectionSourceControlsComponent_div_0_div_1_button_35_Template"),__name(CollectionSourceControlsComponent_div_0_div_1_button_37_Template,"CollectionSourceControlsComponent_div_0_div_1_button_37_Template"),__name(CollectionSourceControlsComponent_div_0_div_1_button_39_Template,"CollectionSourceControlsComponent_div_0_div_1_button_39_Template"),__name(CollectionSourceControlsComponent_div_0_div_1_button_41_Template,"CollectionSourceControlsComponent_div_0_div_1_button_41_Template"),__name(CollectionSourceControlsComponent_div_0_div_1_Template,"CollectionSourceControlsComponent_div_0_div_1_Template"),__name(CollectionSourceControlsComponent_div_0_Template,"CollectionSourceControlsComponent_div_0_Template");class CollectionSourceControlsComponent{constructor(scriptDataService,processDataService,requestService,notificationsService,collectionService,translateService,httpClient,bitstreamService){this.scriptDataService=scriptDataService,this.processDataService=processDataService,this.requestService=requestService,this.notificationsService=notificationsService,this.collectionService=collectionService,this.translateService=translateService,this.httpClient=httpClient,this.bitstreamService=bitstreamService,this.subs=[],this.testConfigRunning$=new cjs.BehaviorSubject(!1),this.importRunning$=new cjs.BehaviorSubject(!1),this.reImportRunning$=new cjs.BehaviorSubject(!1)}ngOnInit(){this.contentSource$=this.collectionService.findByHref(this.collection._links.self.href,!1).pipe((0,shared_operators.mc)(),(0,operators.wt)(collection=>this.collectionService.getContentSource(collection.uuid,!1)),(0,shared_operators.mc)())}testConfiguration(contentSource){this.testConfigRunning$.next(!0),this.subs.push(this.scriptDataService.invoke("harvest",[{name:"-g",value:null},{name:"-a",value:contentSource.oaiSource},{name:"-i",value:(new content_source_set_serializer.q).Serialize(contentSource.oaiSetId)}],[]).pipe((0,shared_operators.hC)(),(0,operators.bw)(rd=>{rd.hasFailed&&(this.notificationsService.error(this.translateService.get("collection.source.controls.test.submit.error")),this.testConfigRunning$.next(!1))}),(0,operators.hX)(rd=>rd.hasSucceeded&&(0,empty_util.Uh)(rd.payload)),(0,operators.wt)(rd=>this.processDataService.findById(rd.payload.processId,!1)),(0,shared_operators.f1)(),(0,operators.hX)(rd=>!rd.isStale&&(rd.hasSucceeded||rd.hasFailed)),(0,operators.UI)(rd=>rd.payload),(0,empty_util.tz)()).subscribe(process=>{process.processStatus.toString()!==process_status_model.N[process_status_model.N.COMPLETED].toString()&&process.processStatus.toString()!==process_status_model.N[process_status_model.N.FAILED].toString()&&setTimeout(()=>{this.requestService.setStaleByHrefSubstring(process._links.self.href)},5e3),process.processStatus.toString()===process_status_model.N[process_status_model.N.FAILED].toString()&&(this.notificationsService.error(this.translateService.get("collection.source.controls.test.failed")),this.testConfigRunning$.next(!1)),process.processStatus.toString()===process_status_model.N[process_status_model.N.COMPLETED].toString()&&(this.bitstreamService.findByHref(process._links.output.href).pipe((0,shared_operators.Gp)()).subscribe(bitstream=>{this.httpClient.get(bitstream._links.content.href,{responseType:"text"}).subscribe(data=>{const output=data.replaceAll(new RegExp(".*\\@(.*)","g"),"$1").replaceAll("The script has started","").replaceAll("The script has completed","");this.notificationsService.info(this.translateService.get("collection.source.controls.test.completed"),output)})}),this.testConfigRunning$.next(!1))}))}importNow(){this.importRunning$.next(!0),this.subs.push(this.scriptDataService.invoke("harvest",[{name:"-r",value:null},{name:"-c",value:this.collection.uuid}],[]).pipe((0,shared_operators.hC)(),(0,operators.bw)(rd=>{rd.hasFailed?(this.notificationsService.error(this.translateService.get("collection.source.controls.import.submit.error")),this.importRunning$.next(!1)):this.notificationsService.success(this.translateService.get("collection.source.controls.import.submit.success"))}),(0,operators.hX)(rd=>rd.hasSucceeded&&(0,empty_util.Uh)(rd.payload)),(0,operators.wt)(rd=>this.processDataService.findById(rd.payload.processId,!1)),(0,shared_operators.f1)(),(0,operators.hX)(rd=>!rd.isStale&&(rd.hasSucceeded||rd.hasFailed)),(0,operators.UI)(rd=>rd.payload),(0,empty_util.tz)()).subscribe(process=>{process.processStatus.toString()!==process_status_model.N[process_status_model.N.COMPLETED].toString()&&process.processStatus.toString()!==process_status_model.N[process_status_model.N.FAILED].toString()&&setTimeout(()=>{this.requestService.setStaleByHrefSubstring(process._links.self.href),this.requestService.setStaleByHrefSubstring(this.collection._links.self.href)},5e3),process.processStatus.toString()===process_status_model.N[process_status_model.N.FAILED].toString()&&(this.notificationsService.error(this.translateService.get("collection.source.controls.import.failed")),this.importRunning$.next(!1)),process.processStatus.toString()===process_status_model.N[process_status_model.N.COMPLETED].toString()&&(this.notificationsService.success(this.translateService.get("collection.source.controls.import.completed")),this.requestService.setStaleByHrefSubstring(this.collection._links.self.href),this.importRunning$.next(!1))}))}resetAndReimport(){this.reImportRunning$.next(!0),this.subs.push(this.scriptDataService.invoke("harvest",[{name:"-o",value:null},{name:"-c",value:this.collection.uuid}],[]).pipe((0,shared_operators.hC)(),(0,operators.bw)(rd=>{rd.hasFailed?(this.notificationsService.error(this.translateService.get("collection.source.controls.reset.submit.error")),this.reImportRunning$.next(!1)):this.notificationsService.success(this.translateService.get("collection.source.controls.reset.submit.success"))}),(0,operators.hX)(rd=>rd.hasSucceeded&&(0,empty_util.Uh)(rd.payload)),(0,operators.wt)(rd=>this.processDataService.findById(rd.payload.processId,!1)),(0,shared_operators.f1)(),(0,operators.hX)(rd=>!rd.isStale&&(rd.hasSucceeded||rd.hasFailed)),(0,operators.UI)(rd=>rd.payload),(0,empty_util.tz)()).subscribe(process=>{process.processStatus.toString()!==process_status_model.N[process_status_model.N.COMPLETED].toString()&&process.processStatus.toString()!==process_status_model.N[process_status_model.N.FAILED].toString()&&setTimeout(()=>{this.requestService.setStaleByHrefSubstring(process._links.self.href),this.requestService.setStaleByHrefSubstring(this.collection._links.self.href)},5e3),process.processStatus.toString()===process_status_model.N[process_status_model.N.FAILED].toString()&&(this.notificationsService.error(this.translateService.get("collection.source.controls.reset.failed")),this.reImportRunning$.next(!1)),process.processStatus.toString()===process_status_model.N[process_status_model.N.COMPLETED].toString()&&(this.notificationsService.success(this.translateService.get("collection.source.controls.reset.completed")),this.requestService.setStaleByHrefSubstring(this.collection._links.self.href),this.reImportRunning$.next(!1))}))}ngOnDestroy(){this.subs.forEach(sub=>{(0,empty_util.Uh)(sub)&&sub.unsubscribe()})}}function CollectionSourceComponent_button_2_Template(rf,ctx){if(1&rf){const _r8=core.EpF();core.TgZ(0,"button",14),core.NdJ("click",__name(function(){core.CHM(_r8);const ctx_r7=core.oxw();return core.KtG(ctx_r7.discard())},"CollectionSourceComponent_button_2_Template_button_click_0_listener")),core.ALo(1,"async"),core._UZ(2,"i",15),core.TgZ(3,"span",6),core._uU(4),core.ALo(5,"translate"),core.qZA()()}if(2&rf){const ctx_r0=core.oxw();core.Q6J("disabled",!core.lcZ(1,2,ctx_r0.hasChanges())),core.xp6(4),core.hij("\xa0",core.lcZ(5,4,"item.edit.metadata.discard-button"),"")}}function CollectionSourceComponent_button_4_Template(rf,ctx){if(1&rf){const _r10=core.EpF();core.TgZ(0,"button",16),core.NdJ("click",__name(function(){core.CHM(_r10);const ctx_r9=core.oxw();return core.KtG(ctx_r9.reinstate())},"CollectionSourceComponent_button_4_Template_button_click_0_listener")),core._UZ(1,"i",17),core.TgZ(2,"span",6),core._uU(3),core.ALo(4,"translate"),core.qZA()()}2&rf&&(core.xp6(3),core.hij("\xa0",core.lcZ(4,1,"item.edit.metadata.reinstate-button"),""))}function CollectionSourceComponent_div_15_Template(rf,ctx){if(1&rf){const _r12=core.EpF();core.TgZ(0,"div",18)(1,"input",19),core.NdJ("change",__name(function(){core.CHM(_r12);const ctx_r11=core.oxw();return core.KtG(ctx_r11.changeExternalSource())},"CollectionSourceComponent_div_15_Template_input_change_1_listener")),core.qZA(),core.TgZ(2,"label",20),core._uU(3),core.ALo(4,"translate"),core.qZA()()}if(2&rf){const ctx_r2=core.oxw();core.xp6(1),core.Q6J("checked",(null==ctx_r2.contentSource?null:ctx_r2.contentSource.harvestType)!==ctx_r2.harvestTypeNone),core.xp6(2),core.Oqu(core.lcZ(4,2,"collection.edit.tabs.source.external"))}}function CollectionSourceComponent_ds_themed_loading_16_Template(rf,ctx){1&rf&&(core._UZ(0,"ds-themed-loading",21),core.ALo(1,"translate")),2&rf&&core.Q6J("message",core.lcZ(1,1,"loading.content-source"))}function CollectionSourceComponent_h4_17_Template(rf,ctx){1&rf&&(core.TgZ(0,"h4"),core._uU(1),core.ALo(2,"translate"),core.qZA()),2&rf&&(core.xp6(1),core.Oqu(core.lcZ(2,1,"collection.edit.tabs.source.form.head")))}function CollectionSourceComponent_ds_form_19_Template(rf,ctx){if(1&rf){const _r14=core.EpF();core.TgZ(0,"ds-form",22),core.NdJ("dfChange",__name(function($event){core.CHM(_r14);const ctx_r13=core.oxw();return core.KtG(ctx_r13.onChange($event))},"CollectionSourceComponent_ds_form_19_Template_ds_form_dfChange_0_listener"))("submitForm",__name(function(){core.CHM(_r14);const ctx_r15=core.oxw();return core.KtG(ctx_r15.onSubmit())},"CollectionSourceComponent_ds_form_19_Template_ds_form_submitForm_0_listener"))("cancel",__name(function(){core.CHM(_r14);const ctx_r16=core.oxw();return core.KtG(ctx_r16.onCancel())},"CollectionSourceComponent_ds_form_19_Template_ds_form_cancel_0_listener")),core.qZA()}if(2&rf){const ctx_r5=core.oxw();core.Q6J("formId","collection-source-form-id")("formGroup",ctx_r5.formGroup)("formModel",ctx_r5.formModel)("formLayout",ctx_r5.formLayout)("displaySubmit",!1)("displayCancel",!1)}}function CollectionSourceComponent_div_20_button_4_Template(rf,ctx){if(1&rf){const _r20=core.EpF();core.TgZ(0,"button",14),core.NdJ("click",__name(function(){core.CHM(_r20);const ctx_r19=core.oxw(2);return core.KtG(ctx_r19.discard())},"CollectionSourceComponent_div_20_button_4_Template_button_click_0_listener")),core.ALo(1,"async"),core._UZ(2,"i",15),core.TgZ(3,"span",6),core._uU(4),core.ALo(5,"translate"),core.qZA()()}if(2&rf){const ctx_r17=core.oxw(2);core.Q6J("disabled",!core.lcZ(1,2,ctx_r17.hasChanges())),core.xp6(4),core.hij("\xa0",core.lcZ(5,4,"item.edit.metadata.discard-button"),"")}}function CollectionSourceComponent_div_20_button_6_Template(rf,ctx){if(1&rf){const _r22=core.EpF();core.TgZ(0,"button",16),core.NdJ("click",__name(function(){core.CHM(_r22);const ctx_r21=core.oxw(2);return core.KtG(ctx_r21.reinstate())},"CollectionSourceComponent_div_20_button_6_Template_button_click_0_listener")),core._UZ(1,"i",17),core.TgZ(2,"span",6),core._uU(3),core.ALo(4,"translate"),core.qZA()()}2&rf&&(core.xp6(3),core.hij("\xa0",core.lcZ(4,1,"item.edit.metadata.reinstate-button"),""))}function CollectionSourceComponent_div_20_Template(rf,ctx){if(1&rf){const _r24=core.EpF();core.TgZ(0,"div",23)(1,"div",10)(2,"div",24)(3,"div",25),core.YNc(4,CollectionSourceComponent_div_20_button_4_Template,6,6,"button",2),core.ALo(5,"async"),core.YNc(6,CollectionSourceComponent_div_20_button_6_Template,5,3,"button",3),core.ALo(7,"async"),core.TgZ(8,"button",4),core.NdJ("click",__name(function(){core.CHM(_r24);const ctx_r23=core.oxw();return core.KtG(ctx_r23.onSubmit())},"CollectionSourceComponent_div_20_Template_button_click_8_listener")),core.ALo(9,"async"),core._UZ(10,"i",5),core.TgZ(11,"span",6),core._uU(12),core.ALo(13,"translate"),core.qZA()()()()()()}if(2&rf){const ctx_r6=core.oxw();core.xp6(4),core.Q6J("ngIf",!core.lcZ(5,4,ctx_r6.isReinstatable())),core.xp6(2),core.Q6J("ngIf",core.lcZ(7,6,ctx_r6.isReinstatable())),core.xp6(2),core.Q6J("disabled",!core.lcZ(9,8,ctx_r6.hasChanges())||!ctx_r6.isValid()||ctx_r6.initialHarvestType===ctx_r6.harvestTypeNone&&ctx_r6.contentSource.harvestType===ctx_r6.initialHarvestType),core.xp6(4),core.hij("\xa0",core.lcZ(13,10,"item.edit.metadata.save-button"),"")}}__name(CollectionSourceControlsComponent,"CollectionSourceControlsComponent"),CollectionSourceControlsComponent.\u0275fac=__name(function(t){return new(t||CollectionSourceControlsComponent)(core.Y36(script_data_service.UY),core.Y36(process_data_service.n),core.Y36(request_service.s),core.Y36(notifications_service.T),core.Y36(collection_data_service.W),core.Y36(ngx_translate_core.sK),core.Y36(http.eN),core.Y36(bitstream_data_service.J))},"CollectionSourceControlsComponent_Factory"),CollectionSourceControlsComponent.\u0275cmp=core.Xpm({type:CollectionSourceControlsComponent,selectors:[["ds-collection-source-controls"]],inputs:{isEnabled:"isEnabled",collection:"collection",shouldShow:"shouldShow"},decls:2,vars:3,consts:[[4,"ngVar"],["class","container-fluid space-children-mr",4,"ngIf"],[1,"container-fluid","space-children-mr"],[1,"font-weight-bold"],["class","btn btn-secondary",3,"disabled","click",4,"ngIf"],["class","btn btn-secondary",3,"disabled",4,"ngIf"],["class","btn btn-primary",3,"disabled","click",4,"ngIf"],["class","btn btn-primary",3,"disabled",4,"ngIf"],[1,"btn","btn-secondary",3,"disabled","click"],[1,"btn","btn-secondary",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","spinner-button"],[1,"btn","btn-primary",3,"disabled","click"],[1,"d-none","d-sm-inline"],[1,"btn","btn-primary",3,"disabled"]],template:__name(function(rf,ctx){1&rf&&(core.YNc(0,CollectionSourceControlsComponent_div_0_Template,2,1,"div",0),core.ALo(1,"async")),2&rf&&core.Q6J("ngVar",core.lcZ(1,1,ctx.contentSource$))},"CollectionSourceControlsComponent_Template"),dependencies:[common.O5,var_directive.g,common.Ov,ngx_translate_core.X$],styles:[".spinner-button[_ngcontent-%COMP%]{margin-bottom:calc((var(--bs-line-height-base) * 1rem - var(--bs-font-size-base)) / 2)}"]}),__name(CollectionSourceComponent_button_2_Template,"CollectionSourceComponent_button_2_Template"),__name(CollectionSourceComponent_button_4_Template,"CollectionSourceComponent_button_4_Template"),__name(CollectionSourceComponent_div_15_Template,"CollectionSourceComponent_div_15_Template"),__name(CollectionSourceComponent_ds_themed_loading_16_Template,"CollectionSourceComponent_ds_themed_loading_16_Template"),__name(CollectionSourceComponent_h4_17_Template,"CollectionSourceComponent_h4_17_Template"),__name(CollectionSourceComponent_ds_form_19_Template,"CollectionSourceComponent_ds_form_19_Template"),__name(CollectionSourceComponent_div_20_button_4_Template,"CollectionSourceComponent_div_20_button_4_Template"),__name(CollectionSourceComponent_div_20_button_6_Template,"CollectionSourceComponent_div_20_button_6_Template"),__name(CollectionSourceComponent_div_20_Template,"CollectionSourceComponent_div_20_Template");class CollectionSourceComponent extends abstract_trackable_component._{constructor(objectUpdatesService,notificationsService,location,formService,translate,route,router2,collectionService,requestService){super(objectUpdatesService,notificationsService,translate),this.objectUpdatesService=objectUpdatesService,this.notificationsService=notificationsService,this.location=location,this.formService=formService,this.translate=translate,this.route=route,this.router=router2,this.collectionService=collectionService,this.requestService=requestService,this.LABEL_KEY_PREFIX="collection.edit.tabs.source.form.",this.ERROR_KEY_PREFIX="collection.edit.tabs.source.form.errors.",this.OPTIONS_KEY_PREFIX="collection.edit.tabs.source.form.options.",this.oaiSourceModel=new fesm2020_core.b1u({id:"oaiSource",name:"oaiSource",required:!0,validators:{required:null},errorMessages:{required:"You must provide a set id of the target collection."}}),this.oaiSetIdModel=new fesm2020_core.b1u({id:"oaiSetId",name:"oaiSetId"}),this.metadataConfigIdModel=new fesm2020_core.nMt({id:"metadataConfigId",name:"metadataConfigId"}),this.harvestTypeModel=new fesm2020_core.TJt({id:"harvestType",name:"harvestType",options:[{value:content_source_model.V.Metadata},{value:content_source_model.V.MetadataAndRef},{value:content_source_model.V.MetadataAndBitstreams}]}),this.inputModels=[this.oaiSourceModel,this.oaiSetIdModel,this.metadataConfigIdModel,this.harvestTypeModel],this.formModel=[new fesm2020_core.S_O({id:"oaiSourceContainer",group:[this.oaiSourceModel]}),new fesm2020_core.S_O({id:"oaiSetContainer",group:[this.oaiSetIdModel,this.metadataConfigIdModel]}),new fesm2020_core.S_O({id:"harvestTypeContainer",group:[this.harvestTypeModel]})],this.formLayout={oaiSource:{grid:{host:"col-12 d-inline-block"}},oaiSetId:{grid:{host:"col col-sm-6 d-inline-block"}},metadataConfigId:{grid:{host:"col col-sm-6 d-inline-block"}},harvestType:{grid:{host:"col-12",option:"btn-outline-secondary"}},oaiSetContainer:{grid:{host:"row"}},oaiSourceContainer:{grid:{host:"row"}},harvestTypeContainer:{grid:{host:"row"}}},this.harvestTypeNone=content_source_model.V.None,this.previouslySelectedHarvestType=content_source_model.V.Metadata,this.displayedNotifications=[]}ngOnInit(){this.notificationsPrefix="collection.edit.tabs.source.notifications.",this.discardTimeOut=environment.N.collection.edit.undoTimeout,this.url=this.router.url,this.url.indexOf("?")>0&&(this.url=this.url.substr(0,this.url.indexOf("?"))),this.formGroup=this.formService.createFormGroup(this.formModel),this.collectionRD$=this.route.parent.data.pipe((0,operators.Ps)(),(0,operators.UI)(data=>data.dso)),this.collectionRD$.pipe((0,shared_operators.xw)(),(0,operators.UI)(col=>col.payload.uuid),(0,operators.wt)(uuid=>this.collectionService.getContentSource(uuid)),(0,shared_operators.hC)()).subscribe(rd=>{this.initializeOriginalContentSource(rd.payload)}),this.updateFieldTranslations(),this.translate.onLangChange.subscribe(()=>{this.updateFieldTranslations()})}initializeOriginalContentSource(contentSource){this.contentSource=contentSource,this.initialHarvestType=contentSource.harvestType,this.initializeMetadataConfigs();const initialContentSource=cloneDeep_default()(this.contentSource);this.objectUpdatesService.initialize(this.url,[initialContentSource],new Date),this.update$=this.objectUpdatesService.getFieldUpdates(this.url,[initialContentSource]).pipe((0,operators.UI)(updates=>updates[initialContentSource.uuid])),this.updateSub=this.update$.subscribe(update=>{if(update){const field=update.field;let configId;(0,empty_util.Uh)(this.contentSource)&&(0,empty_util.UE)(this.contentSource.metadataConfigs)&&(configId=this.contentSource.metadataConfigs[0].id),(0,empty_util.Uh)(field)&&(0,empty_util.Uh)(field.metadataConfigId)&&(configId=field.metadataConfigId),(0,empty_util.Uh)(field)&&(this.formGroup.patchValue({oaiSourceContainer:{oaiSource:field.oaiSource},oaiSetContainer:{oaiSetId:field.oaiSetId,metadataConfigId:configId},harvestTypeContainer:{harvestType:field.harvestType}}),this.contentSource=cloneDeep_default()(field)),this.contentSource.metadataConfigId=configId}})}initializeMetadataConfigs(){this.metadataConfigIdModel.options=this.contentSource.metadataConfigs.map(metadataConfig=>Object.assign({value:metadataConfig.id,label:metadataConfig.label})),this.metadataConfigIdModel.options.length>0&&this.formGroup.patchValue({oaiSetContainer:{metadataConfigId:this.metadataConfigIdModel.options[0].value}})}updateFieldTranslations(){this.inputModels.forEach(fieldModel=>{this.updateFieldTranslation(fieldModel)})}updateFieldTranslation(fieldModel){fieldModel.label=this.translate.instant(this.LABEL_KEY_PREFIX+fieldModel.id),(0,empty_util.UE)(fieldModel.validators)&&(fieldModel.errorMessages={},Object.keys(fieldModel.validators).forEach(key=>{fieldModel.errorMessages[key]=this.translate.instant(this.ERROR_KEY_PREFIX+fieldModel.id+"."+key)})),fieldModel instanceof fesm2020_core.WS&&(0,empty_util.UE)(fieldModel.options)&&fieldModel.options.forEach(option=>{(0,empty_util.xI)(option.label)&&(option.label=this.translate.instant(this.OPTIONS_KEY_PREFIX+fieldModel.id+"."+option.value))})}onChange(event){this.updateContentSourceField(event.model,!0),this.saveFieldUpdate()}onSubmit(){this.collectionRD$.pipe((0,shared_operators.xw)(),(0,operators.UI)(col=>col.payload.uuid),(0,operators.wt)(uuid=>this.collectionService.getHarvesterEndpoint(uuid)),(0,operators.qn)(1)).subscribe(endpoint=>this.requestService.removeByHrefSubstring(endpoint)),this.requestService.setStaleByHrefSubstring(this.contentSource._links.self.href),this.collectionRD$.pipe((0,shared_operators.xw)(),(0,operators.UI)(col=>col.payload.uuid),(0,operators.wt)(uuid=>this.collectionService.updateContentSource(uuid,this.contentSource)),(0,operators.qn)(1)).subscribe(result=>{(0,empty_util.Uh)(result.harvestType)?(this.clearNotifications(),this.initializeOriginalContentSource(result),this.displayedNotifications.push(this.notificationsService.success(this.getNotificationTitle("saved"),this.getNotificationContent("saved")))):this.displayedNotifications.push(result)})}onCancel(){this.location.back()}isValid(){return this.contentSource.harvestType===content_source_model.V.None||this.formGroup.valid}changeExternalSource(){this.contentSource.harvestType===content_source_model.V.None?this.contentSource.harvestType=this.previouslySelectedHarvestType:(this.previouslySelectedHarvestType=this.contentSource.harvestType,this.contentSource.harvestType=content_source_model.V.None),this.updateContentSource(!1)}updateContentSource(updateHarvestType){this.inputModels.forEach(fieldModel=>{this.updateContentSourceField(fieldModel,updateHarvestType)}),this.saveFieldUpdate()}updateContentSourceField(fieldModel,updateHarvestType){(0,empty_util.Uh)(fieldModel.value)&&(fieldModel.id!==this.harvestTypeModel.id||updateHarvestType)&&(this.contentSource[fieldModel.id]=fieldModel.value)}saveFieldUpdate(){this.objectUpdatesService.saveAddFieldUpdate(this.url,cloneDeep_default()(this.contentSource))}clearNotifications(){this.displayedNotifications.forEach(notification=>{this.notificationsService.remove(notification)}),this.displayedNotifications=[]}ngOnDestroy(){this.updateSub&&this.updateSub.unsubscribe()}}__name(CollectionSourceComponent,"CollectionSourceComponent"),CollectionSourceComponent.\u0275fac=__name(function(t){return new(t||CollectionSourceComponent)(core.Y36(object_updates_service.d),core.Y36(notifications_service.T),core.Y36(common.Ye),core.Y36(fesm2020_core.w1X),core.Y36(ngx_translate_core.sK),core.Y36(router.gz),core.Y36(router.F0),core.Y36(collection_data_service.W),core.Y36(request_service.s))},"CollectionSourceComponent_Factory"),CollectionSourceComponent.\u0275cmp=core.Xpm({type:CollectionSourceComponent,selectors:[["ds-collection-source"]],features:[core.qOj],decls:24,vars:27,consts:[[1,"container-fluid"],[1,"d-inline-block","float-right","space-children-mr"],["class"," btn btn-danger",3,"disabled","click",4,"ngIf"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-save"],[1,"d-none","d-sm-inline"],["class","form-check mb-4",4,"ngIf"],[3,"message",4,"ngIf"],[4,"ngIf"],[1,"row"],[3,"formId","formGroup","formModel","formLayout","displaySubmit","displayCancel","dfChange","submitForm","cancel",4,"ngIf"],["class","container mt-2",4,"ngIf"],[3,"isEnabled","shouldShow","collection"],[1,"btn","btn-danger",3,"disabled","click"],[1,"fas","fa-times"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-undo-alt"],[1,"form-check","mb-4"],["type","checkbox","id","externalSourceCheck",1,"form-check-input",3,"checked","change"],["for","externalSourceCheck",1,"form-check-label"],[3,"message"],[3,"formId","formGroup","formModel","formLayout","displaySubmit","displayCancel","dfChange","submitForm","cancel"],[1,"container","mt-2"],[1,"col-12"],[1,"d-inline-block","float-right","ml-1","space-children-mr"]],template:__name(function(rf,ctx){if(1&rf&&(core.TgZ(0,"div",0)(1,"div",1),core.YNc(2,CollectionSourceComponent_button_2_Template,6,6,"button",2),core.ALo(3,"async"),core.YNc(4,CollectionSourceComponent_button_4_Template,5,3,"button",3),core.ALo(5,"async"),core.TgZ(6,"button",4),core.NdJ("click",__name(function(){return ctx.onSubmit()},"CollectionSourceComponent_Template_button_click_6_listener")),core.ALo(7,"async"),core._UZ(8,"i",5),core.TgZ(9,"span",6),core._uU(10),core.ALo(11,"translate"),core.qZA()()(),core.TgZ(12,"h4"),core._uU(13),core.ALo(14,"translate"),core.qZA(),core.YNc(15,CollectionSourceComponent_div_15_Template,5,4,"div",7),core.YNc(16,CollectionSourceComponent_ds_themed_loading_16_Template,2,3,"ds-themed-loading",8),core.YNc(17,CollectionSourceComponent_h4_17_Template,3,3,"h4",9),core.qZA(),core.TgZ(18,"div",10),core.YNc(19,CollectionSourceComponent_ds_form_19_Template,1,6,"ds-form",11),core.qZA(),core.YNc(20,CollectionSourceComponent_div_20_Template,14,12,"div",12),core._UZ(21,"ds-collection-source-controls",13),core.ALo(22,"async"),core.ALo(23,"async")),2&rf){let tmp_12_0;core.xp6(2),core.Q6J("ngIf",!core.lcZ(3,13,ctx.isReinstatable())),core.xp6(2),core.Q6J("ngIf",core.lcZ(5,15,ctx.isReinstatable())),core.xp6(2),core.Q6J("disabled",!core.lcZ(7,17,ctx.hasChanges())||!ctx.isValid()||ctx.initialHarvestType===ctx.harvestTypeNone&&ctx.contentSource.harvestType===ctx.initialHarvestType),core.xp6(4),core.hij("\xa0",core.lcZ(11,19,"item.edit.metadata.save-button"),""),core.xp6(3),core.Oqu(core.lcZ(14,21,"collection.edit.tabs.source.head")),core.xp6(2),core.Q6J("ngIf",ctx.contentSource),core.xp6(1),core.Q6J("ngIf",!ctx.contentSource),core.xp6(1),core.Q6J("ngIf",ctx.contentSource&&(null==ctx.contentSource?null:ctx.contentSource.harvestType)!==ctx.harvestTypeNone),core.xp6(2),core.Q6J("ngIf",ctx.formGroup&&ctx.contentSource&&(null==ctx.contentSource?null:ctx.contentSource.harvestType)!==ctx.harvestTypeNone),core.xp6(1),core.Q6J("ngIf",(null==ctx.contentSource?null:ctx.contentSource.harvestType)!==ctx.harvestTypeNone),core.xp6(1),core.Q6J("isEnabled",!core.lcZ(22,23,ctx.hasChanges()))("shouldShow",(null==ctx.contentSource?null:ctx.contentSource.harvestType)!==ctx.harvestTypeNone)("collection",null==(tmp_12_0=core.lcZ(23,25,ctx.collectionRD$))?null:tmp_12_0.payload)}},"CollectionSourceComponent_Template"),dependencies:[common.O5,fesm2020_forms.JL,fesm2020_forms.sg,themed_loading_component.Z,form_component.U,CollectionSourceControlsComponent,common.Ov,ngx_translate_core.X$],encapsulation:2});var curation_form_component=__webpack_require__(52069);const collection_curate_component_c0=__name(function(a0){return{collection:a0}},"collection_curate_component_c0");class CollectionCurateComponent{constructor(route,dsoNameService){this.route=route,this.dsoNameService=dsoNameService}ngOnInit(){this.dsoRD$=this.route.parent.data.pipe((0,operators.qn)(1),(0,operators.UI)(data=>data.dso)),this.collectionName$=this.dsoRD$.pipe((0,operators.hX)(rd=>(0,empty_util.Uh)(rd)),(0,operators.UI)(rd=>this.dsoNameService.getName(rd.payload)))}}__name(CollectionCurateComponent,"CollectionCurateComponent"),CollectionCurateComponent.\u0275fac=__name(function(t){return new(t||CollectionCurateComponent)(core.Y36(router.gz),core.Y36(dso_name_service._))},"CollectionCurateComponent_Factory"),CollectionCurateComponent.\u0275cmp=core.Xpm({type:CollectionCurateComponent,selectors:[["ds-collection-curate"]],decls:7,vars:11,consts:[[1,"container"],[3,"dsoHandle"]],template:__name(function(rf,ctx){if(1&rf&&(core.TgZ(0,"div",0)(1,"h3"),core._uU(2),core.ALo(3,"translate"),core.ALo(4,"async"),core.qZA(),core._UZ(5,"ds-curation-form",1),core.ALo(6,"async"),core.qZA()),2&rf){let tmp_1_0;core.xp6(2),core.Oqu(core.xi3(3,2,"collection.curate.header",core.VKq(9,collection_curate_component_c0,core.lcZ(4,5,ctx.collectionName$)))),core.xp6(3),core.Q6J("dsoHandle",null==(tmp_1_0=core.lcZ(6,7,ctx.dsoRD$))?null:tmp_1_0.payload.handle)}},"CollectionCurateComponent_Template"),dependencies:[curation_form_component._,common.Ov,ngx_translate_core.X$],encapsulation:2});var resource_policies_component=__webpack_require__(96925);class CollectionAuthorizationsComponent{constructor(route){this.route=route}ngOnInit(){this.dsoRD$=this.route.parent.parent.data.pipe((0,operators.Ps)(),(0,operators.UI)(data=>data.dso))}}__name(CollectionAuthorizationsComponent,"CollectionAuthorizationsComponent"),CollectionAuthorizationsComponent.\u0275fac=__name(function(t){return new(t||CollectionAuthorizationsComponent)(core.Y36(router.gz))},"CollectionAuthorizationsComponent_Factory"),CollectionAuthorizationsComponent.\u0275cmp=core.Xpm({type:CollectionAuthorizationsComponent,selectors:[["ds-collection-authorizations"]],decls:3,vars:4,consts:[[1,"container"],[3,"resourceType","resourceUUID"]],template:__name(function(rf,ctx){if(1&rf&&(core.TgZ(0,"div",0),core._UZ(1,"ds-resource-policies",1),core.ALo(2,"async"),core.qZA()),2&rf){let tmp_1_0;core.xp6(1),core.Q6J("resourceType","collection")("resourceUUID",null==(tmp_1_0=core.lcZ(2,2,ctx.dsoRD$))||null==tmp_1_0.payload?null:tmp_1_0.payload.id)}},"CollectionAuthorizationsComponent_Template"),dependencies:[resource_policies_component.F,common.Ov],encapsulation:2});var i18n_breadcrumb_resolver=__webpack_require__(96478),resource_policy_target_resolver=__webpack_require__(333),resource_policy_create_component=__webpack_require__(4367),resource_policy_resolver=__webpack_require__(38286),resource_policy_edit_component=__webpack_require__(37175),single_feature_authorization_guard=__webpack_require__(16191),authorization_data_service=__webpack_require__(32418),auth_service=__webpack_require__(22410);class CollectionAdministratorGuard extends single_feature_authorization_guard.C{constructor(authorizationService,router2,authService){super(authorizationService,router2,authService),this.authorizationService=authorizationService,this.router=router2,this.authService=authService}getFeatureID(route,state){return(0,cjs.of)(feature_id.i.IsCollectionAdmin)}}__name(CollectionAdministratorGuard,"CollectionAdministratorGuard"),CollectionAdministratorGuard.\u0275fac=__name(function(t){return new(t||CollectionAdministratorGuard)(core.LFG(authorization_data_service._),core.LFG(router.F0),core.LFG(auth_service.e8))},"CollectionAdministratorGuard_Factory"),CollectionAdministratorGuard.\u0275prov=core.Yz7({token:CollectionAdministratorGuard,factory:CollectionAdministratorGuard.\u0275fac,providedIn:"root"});var access_control_form_container_component=__webpack_require__(94457);function CollectionAccessControlComponent_ds_access_control_form_container_0_Template(rf,ctx){if(1&rf&&core._UZ(0,"ds-access-control-form-container",1),2&rf){const itemRD_r1=ctx.ngIf;core.Q6J("itemRD",itemRD_r1)("showLimitToSpecificBitstreams",!1)}}__name(CollectionAccessControlComponent_ds_access_control_form_container_0_Template,"CollectionAccessControlComponent_ds_access_control_form_container_0_Template");class CollectionAccessControlComponent{constructor(route){this.route=route}ngOnInit(){this.itemRD$=this.route.parent.parent.data.pipe((0,operators.UI)(data=>data.dso)).pipe((0,shared_operators.xw)())}}__name(CollectionAccessControlComponent,"CollectionAccessControlComponent"),CollectionAccessControlComponent.\u0275fac=__name(function(t){return new(t||CollectionAccessControlComponent)(core.Y36(router.gz))},"CollectionAccessControlComponent_Factory"),CollectionAccessControlComponent.\u0275cmp=core.Xpm({type:CollectionAccessControlComponent,selectors:[["ds-collection-access-control"]],decls:2,vars:3,consts:[["titleMessage","collection-access-control-title",3,"itemRD","showLimitToSpecificBitstreams",4,"ngIf"],["titleMessage","collection-access-control-title",3,"itemRD","showLimitToSpecificBitstreams"]],template:__name(function(rf,ctx){1&rf&&(core.YNc(0,CollectionAccessControlComponent_ds_access_control_form_container_0_Template,1,2,"ds-access-control-form-container",0),core.ALo(1,"async")),2&rf&&core.Q6J("ngIf",core.lcZ(1,1,ctx.itemRD$))},"CollectionAccessControlComponent_Template"),dependencies:[common.O5,access_control_form_container_component.x,common.Ov]});class EditCollectionPageRoutingModule{}__name(EditCollectionPageRoutingModule,"EditCollectionPageRoutingModule"),EditCollectionPageRoutingModule.\u0275fac=__name(function(t){return new(t||EditCollectionPageRoutingModule)},"EditCollectionPageRoutingModule_Factory"),EditCollectionPageRoutingModule.\u0275mod=core.oAB({type:EditCollectionPageRoutingModule}),EditCollectionPageRoutingModule.\u0275inj=core.cJS({providers:[resource_policy_resolver.b,resource_policy_target_resolver.a],imports:[router.Bz.forChild([{path:"",resolve:{breadcrumb:i18n_breadcrumb_resolver.t},data:{breadcrumbKey:"collection.edit"},component:EditCollectionPageComponent,canActivate:[CollectionAdministratorGuard],children:[{path:"",redirectTo:"metadata",pathMatch:"full"},{path:"metadata",component:CollectionMetadataComponent,data:{title:"collection.edit.tabs.metadata.title",hideReturnButton:!0,showBreadcrumbs:!0}},{path:"roles",component:CollectionRolesComponent,data:{title:"collection.edit.tabs.roles.title",showBreadcrumbs:!0}},{path:"source",component:CollectionSourceComponent,data:{title:"collection.edit.tabs.source.title",showBreadcrumbs:!0}},{path:"curate",component:CollectionCurateComponent,data:{title:"collection.edit.tabs.curate.title",showBreadcrumbs:!0}},{path:"access-control",component:CollectionAccessControlComponent,data:{title:"collection.edit.tabs.access-control.title",showBreadcrumbs:!0}},{path:"authorizations",data:{showBreadcrumbs:!0},children:[{path:"create",resolve:{resourcePolicyTarget:resource_policy_target_resolver.a},component:resource_policy_create_component.v,data:{title:"resource-policies.create.page.title"}},{path:"edit",resolve:{resourcePolicy:resource_policy_resolver.b},component:resource_policy_edit_component.x,data:{title:"resource-policies.edit.page.title"}},{path:"",component:CollectionAuthorizationsComponent,data:{title:"collection.edit.tabs.authorizations.title",showBreadcrumbs:!0}}]},{path:"mapper",component:CollectionItemMapperComponent,data:{title:"collection.edit.tabs.item-mapper.title",hideReturnButton:!0,showBreadcrumbs:!0}}]}])]});var collection_form_module=__webpack_require__(60675),resource_policies_module=__webpack_require__(21574),form_module=__webpack_require__(80913),comcol_module=__webpack_require__(88122),access_control_form_module=__webpack_require__(6363);class EditCollectionPageModule{}__name(EditCollectionPageModule,"EditCollectionPageModule"),EditCollectionPageModule.\u0275fac=__name(function(t){return new(t||EditCollectionPageModule)},"EditCollectionPageModule_Factory"),EditCollectionPageModule.\u0275mod=core.oAB({type:EditCollectionPageModule}),EditCollectionPageModule.\u0275inj=core.cJS({imports:[common.ez,shared_module.m,EditCollectionPageRoutingModule,collection_form_module.s,resource_policies_module.q,form_module.e,comcol_module.H,access_control_form_module.J]})}};